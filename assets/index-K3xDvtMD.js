import{b as K,ah as d,o as i,M as b,O as l,U as t,u as z,S as m,a8 as B,ax as T,ay as M,a as n,Z as Ie,i as Te,R as S,T as $,c as f,a7 as H,F as E,P as de,V as ue,J as X,as as Me}from"./@vue-sUlnragZ.js";import{E as I,a as R,b as W,c as J,d as he,e as Q,f as Re,g as _e,h as me,i as Ue,l as Be}from"./element-plus-BpzAzIuu.js";import{u as Ee,c as He,a as Ae}from"./vue-router-B6X9H5Yn.js";import{Q as P,R as ve,S as Pe,T as Le,U as Ne,V as je,W as pe,X as ye,w as Oe,Y as Fe,Z as Ce,_ as ke,C as Ke,$ as qe,a0 as Ye}from"./@element-plus-DKHGFxwB.js";import{a as fe}from"./axios-Cm0UX6qg.js";import{d as Ge,c as Ze}from"./pinia-DEOcsSk7.js";import{c as Xe}from"./canvas-confetti-aNA1zn9t.js";import{i as De}from"./echarts-ClI3r9IS.js";import{V as We}from"./zrender-FvJ5BCQ2.js";import{c as Je}from"./pinia-persistedstate-plugin-D-cTam46.js";import"./lodash-es-WEemOz_S.js";import"./@vueuse-DCWJsjZ0.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-CbdKYntM.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-CtcGg-6p.js";import"./tslib-BDyQ-Jie.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))p(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&p(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function p(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();const ee=Ge("token",()=>{const e=K("");return{token:e,setToken:p=>{e.value=p},removeToken:()=>{e.value=""}}},{persist:!1}),Qe="/api",D=fe.create({baseURL:Qe});D.interceptors.request.use(e=>{const o=ee();return console.log("Setting Authorization header:",o.token),o.token&&(e.headers.Authorization=o.token),e},e=>Promise.reject(e));D.interceptors.response.use(e=>{if(e.data.msg==="The token is null."||e.data.msg==="non null key required")I.error("请登录"),G.push("/login");else{if(e.data.code===200)return console.log(e.data),e.data;if(e.data.msg==="操作失败"&&e.data.code===201)I.error("请登录"),G.push("/login");else return I.error(e.data.msg?e.data.msg:"服务异常"),Promise.reject(e.data)}},e=>{if(e.response.status===401)I.error("请登录"),G.push("/login");else if(e.data.msg==="The token is null.")I.error("请登录"),G.push("/login");else return I.error("服务异常"),Promise.reject(e)});const te=function(e){console.log(e);const o=K("");e===1&&(o.value="/api/stu/export"),e===2&&(o.value="/api/rec/downloadModel"),e===3&&(o.value="/api/score/export"),e===4&&(o.value="/api/score2/export"),console.log(o.value);let p=ee().token;return fe({method:"get",url:o.value,headers:{Authorization:p},responseType:"blob"}).then(function(a){if(a.headers["content-disposition"]!==void 0){let s=new Blob([a.data],{type:"application/vnd.ms-excel;charset=utf-8"}),c=decodeURI(a.headers["content-disposition"]);c&&(c=c.substring(c.indexOf("=")+1));const _=document.createElement("a");_.download=c,_.style.display="none",_.href=URL.createObjectURL(s),document.body.appendChild(_),_.click(),URL.revokeObjectURL(_.href),document.body.removeChild(_)}})},et=e=>D.post("/users/register",e),tt=e=>D.post("/users/login",e),V=(e,o)=>{const r=e.__vccOpts||e;for(const[p,a]of o)r[p]=a;return r},oe=e=>(T("data-v-c8453146"),e=e(),M(),e),ot=oe(()=>n("h2",null,"注册",-1)),lt=oe(()=>n("span",null,"注册已关闭",-1)),at=oe(()=>n("div",null,[n("h1",{style:{"font-weight":"bold","font-size":"50px",color:"black","margin-bottom":"0"}},"stuTrack"),n("h2",{style:{color:"gray","font-size":"30px","margin-top":"0"}},"v0.13.0-alpha")],-1)),st=oe(()=>n("h2",null,"登录",-1)),nt=oe(()=>n("div",{class:"flex"},[n("span",null,"若忘记密码请联系管理员，暂不支持自助找回")],-1)),rt={__name:"Login",setup(e){const o=K(!1),r=K({username:"",password:"",rePassword:"",role_id:8}),a={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:16,message:"请输入5-16位用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,max:128,message:"请输入8-16位密码",trigger:"blur"}],rePassword:[{validator:(g,y,x)=>{y===""?x(new Error("请确认您的密码")):y!=r.value.password?x(new Error("两次密码输入不一致，请检查")):x()},trigger:"blur"}]},s=async()=>{let g=await et(r.value);I.success(g.message?g.message:"注册成功")},c=Ee(),_=ee(),v=async()=>{let g=await tt(r.value);I.success(g.message?g.message:"登录成功"),_.setToken(g.data),Xe({particleCount:200,spread:100,origin:{y:.6},colors:["#ff0000","#00ff00","#0000ff","#ff00ff","#ffff00"],shapes:["circle","square","heart","triangle"],size:8,rotate:!0,fallSpeed:6,angle:90}),c.push("/")},w=()=>{r.value={username:"",password:"",rePassword:"",role_id:8}};return(g,y)=>{const x=d("el-col"),h=d("el-form-item"),u=d("el-input"),k=d("el-button"),q=d("el-link"),Y=d("el-form"),F=d("el-row");return i(),b(F,{class:"login-page"},{default:l(()=>[t(x,{span:12,class:"bg"}),t(x,{span:6,offset:3,class:"form"},{default:l(()=>[o.value?(i(),b(Y,{key:0,ref:"form",size:"large",autocomplete:"off",model:r.value,rules:a},{default:l(()=>[t(h,null,{default:l(()=>[ot]),_:1}),t(h,{prop:"username"},{default:l(()=>[t(u,{"prefix-icon":z(P),placeholder:"请输入用户名",modelValue:r.value.username,"onUpdate:modelValue":y[0]||(y[0]=U=>r.value.username=U)},null,8,["prefix-icon","modelValue"])]),_:1}),t(h,{prop:"password"},{default:l(()=>[t(u,{"prefix-icon":z(ve),type:"password",placeholder:"请输入密码",modelValue:r.value.password,"onUpdate:modelValue":y[1]||(y[1]=U=>r.value.password=U)},null,8,["prefix-icon","modelValue"])]),_:1}),t(h,{prop:"rePassword"},{default:l(()=>[t(u,{"prefix-icon":z(ve),type:"password",placeholder:"请输入再次密码",modelValue:r.value.rePassword,"onUpdate:modelValue":y[2]||(y[2]=U=>r.value.rePassword=U)},null,8,["prefix-icon","modelValue"])]),_:1}),lt,t(h,null,{default:l(()=>[t(k,{class:"button",type:"primary",disabled:"","auto-insert-space":"",onClick:s},{default:l(()=>[m(" 注册 ")]),_:1})]),_:1}),t(h,{class:"flex"},{default:l(()=>[t(q,{type:"info",underline:!1,onClick:y[3]||(y[3]=U=>{o.value=!1,w()})},{default:l(()=>[m(" ← 返回 ")]),_:1})]),_:1})]),_:1},8,["model"])):(i(),b(Y,{key:1,ref:"form",size:"large",autocomplete:"off",model:r.value},{default:l(()=>[t(h,null,{default:l(()=>[at]),_:1}),t(h,null,{default:l(()=>[st]),_:1}),t(h,{prop:"username"},{default:l(()=>[t(u,{"prefix-icon":z(P),placeholder:"请输入用户名",modelValue:r.value.username,"onUpdate:modelValue":y[4]||(y[4]=U=>r.value.username=U),rules:a},null,8,["prefix-icon","modelValue"])]),_:1}),t(h,{prop:"password"},{default:l(()=>[t(u,{name:"password","prefix-icon":z(ve),type:"password",placeholder:"请输入密码",modelValue:r.value.password,"onUpdate:modelValue":y[5]||(y[5]=U=>r.value.password=U),onKeyup:B(v,["enter","native"])},null,8,["prefix-icon","modelValue"])]),_:1}),t(h,{class:"flex"},{default:l(()=>[nt]),_:1}),t(h,null,{default:l(()=>[t(k,{class:"button",type:"primary","auto-insert-space":"",onClick:v},{default:l(()=>[m("登录")]),_:1})]),_:1}),t(h,{class:"flex"},{default:l(()=>[t(q,{type:"info",underline:!1,onClick:y[6]||(y[6]=U=>{o.value=!0,w()})},{default:l(()=>[m(" 注册 → ")]),_:1})]),_:1})]),_:1},8,["model"]))]),_:1})]),_:1})}}},it=V(rt,[["__scopeId","data-v-c8453146"]]),ct="/stuTrackFrontend/assets/default-BOOhfdlH.png",C=e=>(T("data-v-94edbddf"),e=e(),M(),e),dt=C(()=>n("div",{class:"el-aside__logo"},null,-1)),ut=C(()=>n("span",null,"首页",-1)),pt=C(()=>n("span",null,"About",-1)),ht=C(()=>n("span",null,"一步",-1)),_t=C(()=>n("span",null,"学生管理",-1)),mt=C(()=>n("span",null,"学生名册",-1)),ft=C(()=>n("span",null,"学生表上传",-1)),gt=C(()=>n("span",null,"学生表导出",-1)),bt=C(()=>n("span",null,"通报预警",-1)),vt=C(()=>n("span",null,"记录管理",-1)),yt=C(()=>n("span",null,"记录管理",-1)),Dt=C(()=>n("span",null,"信息录入",-1)),wt=C(()=>n("span",null,"德育分中心",-1)),xt=C(()=>n("span",null,"记录管理",-1)),zt=C(()=>n("span",null,"批量导入",-1)),Ft=C(()=>n("span",null,"德育分导出",-1)),Ct=C(()=>n("span",null,"德育分中心",-1)),kt=C(()=>n("span",null,"第二课堂积分",-1)),St=C(()=>n("span",null,"记录管理",-1)),Vt=C(()=>n("span",null,"批量导入",-1)),$t=C(()=>n("span",null,"导出",-1)),It=C(()=>n("span",null,"第二课堂积分",-1)),Tt=C(()=>n("span",null,"文件流转",-1)),Mt=C(()=>n("span",null,"文件流转",-1)),Rt=C(()=>n("span",null,"用户管理",-1)),Ut=C(()=>n("span",null,"个人中心",-1)),Bt=C(()=>n("span",null,"开发中",-1)),Et={class:"el-dropdown__box"},Ht=C(()=>n("br",null,null,-1)),At={__name:"Layout",setup(e){const o=()=>{D.get("/users/logout").then(p=>{I.success("退出成功"),G.push("/login")}).catch(p=>{console.error(p)})},r=Ie({username:null,name:null,roleData:null});return Te(async()=>{try{const p=await D.get("/users/role");r.roleData=p.data}catch(p){console.error(p)}try{const p=await D.get("/users/username");r.username=p.data}catch(p){console.error(p),r.username="NaN"}try{const p=await D.get("/users/name");r.name=p.data}catch(p){console.error(p),r.name="未登录"}}),(p,a)=>{const s=d("el-icon"),c=d("el-menu-item"),_=d("el-sub-menu"),v=d("el-menu"),w=d("el-aside"),g=d("el-tag"),y=d("el-avatar"),x=d("el-dropdown-item"),h=d("el-dropdown-menu"),u=d("el-dropdown"),k=d("el-header"),q=d("router-view"),Y=d("el-main"),F=d("center"),U=d("el-footer"),ce=d("el-container");return i(),b(ce,{class:"layout-container"},{default:l(()=>[t(w,{width:"200px"},{default:l(()=>[dt,t(v,{"active-text-color":"#ed6b60","background-color":"#f4f4f4","text-color":"#FFFFF",router:""},{default:l(()=>[t(c,{index:"/dev"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(Pe))]),_:1}),ut]),_:1}),t(c,{index:"/description"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(Le))]),_:1}),pt]),_:1}),t(c,{index:"/oneStep"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(Ne))]),_:1}),ht]),_:1}),t(_,{index:"1"},{title:l(()=>[t(s,null,{default:l(()=>[t(z(je))]),_:1}),_t]),default:l(()=>[t(c,{index:"/stu/stuManage"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(P))]),_:1}),mt]),_:1}),r.roleData&&r.roleData<=11?(i(),b(c,{key:0,index:"/stu/uploadFile"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(pe))]),_:1}),ft]),_:1})):S("",!0),t(c,{index:"/stu/exportExcel"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(ye))]),_:1}),gt]),_:1})]),_:1}),t(_,{index:"4"},{title:l(()=>[t(s,null,{default:l(()=>[t(z(Oe))]),_:1}),bt]),default:l(()=>[r.roleData&&r.roleData<=11?(i(),b(c,{key:0,index:"/discipline/manage"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(P))]),_:1}),vt]),_:1})):S("",!0),r.roleData>11?(i(),b(c,{key:1,index:"/dpBlocked"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(P))]),_:1}),yt]),_:1})):S("",!0),t(c,{index:"/discipline/push"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(pe))]),_:1}),Dt]),_:1})]),_:1}),r.roleData&&r.roleData<=11?(i(),b(_,{key:0,index:"2"},{title:l(()=>[t(s,null,{default:l(()=>[t(z(Fe))]),_:1}),wt]),default:l(()=>[t(c,{index:"/oprRec/recManage"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(P))]),_:1}),xt]),_:1}),t(c,{index:"/oprRec/upload"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(pe))]),_:1}),zt]),_:1}),t(c,{index:"/oprRec/exportExcel"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(ye))]),_:1}),Ft]),_:1})]),_:1})):S("",!0),r.roleData>11?(i(),b(c,{key:1,index:"/orblocked"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(Fe))]),_:1}),Ct]),_:1})):S("",!0),r.roleData&&r.roleData<=11?(i(),b(_,{key:2,index:"21"},{title:l(()=>[t(s,null,{default:l(()=>[t(z(Ce))]),_:1}),kt]),default:l(()=>[t(c,{index:"/oprRec2/recManage"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(P))]),_:1}),St]),_:1}),t(c,{index:"/oprRec2/upload"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(pe))]),_:1}),Vt]),_:1}),t(c,{index:"/oprRec2/exportExcel"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(ye))]),_:1}),$t]),_:1})]),_:1})):S("",!0),r.roleData>11?(i(),b(c,{key:3,index:"/or2blocked"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(Ce))]),_:1}),It]),_:1})):S("",!0),r.roleData&&r.roleData<=11?(i(),b(c,{key:4,index:"/files"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(ke))]),_:1}),Tt]),_:1})):S("",!0),r.roleData>11?(i(),b(c,{key:5,index:"/fcblocked"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(ke))]),_:1}),Mt]),_:1})):S("",!0),r.roleData&&r.roleData==8?(i(),b(c,{key:6,index:"/user/userManage"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(P))]),_:1}),Rt]),_:1})):S("",!0),r.roleData&&r.roleData<=11?(i(),b(_,{key:7,index:"3"},{title:l(()=>[t(s,null,{default:l(()=>[t(z(Ke))]),_:1}),Ut]),default:l(()=>[t(c,{index:"/user/info"},{default:l(()=>[t(s,null,{default:l(()=>[t(z(P))]),_:1}),Bt]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1}),t(ce,null,{default:l(()=>[t(k,null,{default:l(()=>[n("div",null,[m("当前用户："),n("strong",null,$(r.name),1)]),n("div",null,[m("用户名："),n("strong",null,$(r.username),1)]),t(u,{placement:"bottom-end"},{dropdown:l(()=>[t(h,null,{default:l(()=>[t(x,{command:"logout",icon:z(qe),onClick:o},{default:l(()=>[m("退出登录")]),_:1},8,["icon"])]),_:1})]),default:l(()=>[n("span",Et,[r.roleData===8?(i(),b(g,{key:0,class:"custom-tag"},{default:l(()=>[m("超级管理员")]),_:1})):S("",!0),r.roleData===4?(i(),b(g,{key:1,class:"custom-tag"},{default:l(()=>[m("学生工作办公室")]),_:1})):S("",!0),r.roleData===11?(i(),b(g,{key:2,class:"custom-tag"},{default:l(()=>[m("综合部")]),_:1})):S("",!0),r.roleData===12?(i(),b(g,{key:3,class:"custom-tag"},{default:l(()=>[m("团委")]),_:1})):S("",!0),r.roleData===13?(i(),b(g,{key:4,class:"custom-tag"},{default:l(()=>[m("公管")]),_:1})):S("",!0),r.roleData===14?(i(),b(g,{key:5,class:"custom-tag"},{default:l(()=>[m("学习部")]),_:1})):S("",!0),r.roleData===15?(i(),b(g,{key:6,class:"custom-tag"},{default:l(()=>[m("授权用户")]),_:1})):S("",!0),t(y,{src:z(ct)},null,8,["src"]),t(s,null,{default:l(()=>[t(z(Ye))]),_:1})])]),_:1})]),_:1}),t(Y,null,{default:l(()=>[t(q)]),_:1}),t(U,null,{default:l(()=>[t(F,null,{default:l(()=>[m("stuTrack Developed by 张丰伟"),Ht,m("Version: v0.13.0-alpha")]),_:1})]),_:1})]),_:1})]),_:1})}}},Pt=V(At,[["__scopeId","data-v-94edbddf"]]),Lt={mounted(){this.fetchChartData(),this.fetchUpdateInfo()},methods:{async fetchChartData(){try{const o=(await D.get("/stu/chartData")).data,r=this.mapData(o);this.renderCharts(r)}catch(e){console.error("Error fetching chart data",e)}},mapData(e){return e.map(o=>({year:o.grade+"级",total:o.total_students,male:o.male_students,female:o.female_students,boarding:o.day_scholars}))},renderCharts(e){const o=De(this.$refs.gradeChart),r=this.getGradeOption(e);o.setOption(r);const p=De(this.$refs.genderChart),a=this.getGenderOption(e);p.setOption(a);const s=De(this.$refs.boardingChart),c=this.getBoardingOption(e);s.setOption(c)},getGradeOption(e){return{title:{text:"各年级人数数据",left:"center"},grid:{left:"10%",right:"10%"},xAxis:{data:e.map(o=>o.year),axisLabel:{rotate:45}},yAxis:{},tooltip:{trigger:"axis"},series:[{name:"总人数",type:"bar",itemStyle:{color:new We(0,0,0,1,[{offset:0,color:"#7FFFD4"},{offset:1,color:"#00CED1"}])},data:e.map(o=>o.total)}]}},getGenderOption(e){return{title:{text:"男女比例数据",left:"center"},grid:{left:"10%",right:"10%"},xAxis:{data:e.map(o=>o.year),axisLabel:{rotate:45}},yAxis:{},tooltip:{trigger:"axis"},series:[{name:"男",type:"line",itemStyle:{color:"#FF6347"},data:e.map(o=>o.male)},{name:"女",type:"line",itemStyle:{color:"#6A5ACD"},data:e.map(o=>o.female)}]}},getBoardingOption(e){return{title:{text:"走读数据",left:"center"},grid:{left:"10%",right:"10%"},xAxis:{data:e.map(o=>o.year),axisLabel:{rotate:45}},yAxis:{},tooltip:{trigger:"item",formatter:"{b}: {c}人"},series:[{name:"走读人数",type:"pie",radius:"50%",center:["50%","50%"],itemStyle:{color:function(o){var r=["#FFA07A","#9370DB","#00FFFF","#D8BFD8"];return r[o.dataIndex]}},data:e.map(o=>({value:o.boarding,name:o.year}))}]}},async fetchUpdateInfo(){try{const o=await(await fetch("src/assets/update.html")).text();this.updateInfo=o}catch(e){console.error("Error fetching update information",e)}}},data(){return{updateInfo:null}}},Nt=e=>(T("data-v-88536bf0"),e=e(),M(),e),jt={class:"dashboard"},Ot={class:"chart-column"},Kt={class:"chart",ref:"gradeChart"},qt={class:"chart",ref:"genderChart"},Yt={class:"chart",ref:"boardingChart"},Gt={class:"chart-column"},Zt={class:"chart",ref:"progressChart"},Xt={class:"update-info-container"},Wt={key:0,class:"update-info"},Jt=Nt(()=>n("h2",null,"更新日志",-1)),Qt=["innerHTML"];function eo(e,o,r,p,a,s){return i(),f("div",jt,[n("div",Ot,[n("div",Kt,null,512),n("div",qt,null,512),n("div",Yt,null,512)]),n("div",Gt,[n("div",Zt,null,512)]),n("div",Xt,[a.updateInfo?(i(),f("div",Wt,[Jt,n("div",{innerHTML:a.updateInfo},null,8,Qt)])):S("",!0)])])}const to=V(Lt,[["render",eo],["__scopeId","data-v-88536bf0"]]),oo={name:"DevelopmentPage"},le=e=>(T("data-v-f339855d"),e=e(),M(),e),lo={class:"development-page"},ao={class:"icon",style:{width:"6em",height:"6em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7508"},so=le(()=>n("path",{d:"M443.83 908.912c21.615 0 32.265-7.876 35.84-17.082 33.996-87.822 95.837-525.508 120.44-573.152 23.404-45.335 78.271-43.818 164.595 4.543a9.31 9.31 0 0 0 13.153-4.562l43.474-104.95a4.971 4.971 0 0 0-2.365-6.349c-73.886-37.153-159.65-58.415-251.112-58.415-58.182 0-114.065 8.602-166.037 24.428-59.644 18.152-99.933 48.407-127.135 87.095-2.448 3.491-3.872 12.903 5.79 12.903 25.787 0 97.476-12.903 123.393-17.064 26-4.17 70.032-11.785 79.527 21.579 12.493 43.948-58.647 312.18-81.575 381.56-22.985 69.502-41.9 141.331-51.182 180.597-2.448 10.333 0 32.703 12.046 42.636 11.776 9.681 50.409 26.233 81.148 26.233z",fill:"#FFAE00","p-id":"7509"},null,-1)),no=le(()=>n("path",{d:"M781.898 175.523l68.553 29.1-60.156 141.703-68.552-29.09z",fill:"#D8D8D8","p-id":"7510"},null,-1)),ro=le(()=>n("path",{d:"M443.83 908.912c21.615 0 32.265-7.876 35.84-17.082 15.304-39.564 44.301-182.542 86.974-428.945l-104.187-32.377c-31.874 126.762-52.094 203.078-60.64 228.939-22.984 69.501-41.9 141.33-51.18 180.596-2.45 10.333 0 32.703 12.045 42.636 11.776 9.681 50.409 26.233 81.148 26.233z",fill:"#42434D","p-id":"7511"},null,-1)),io=le(()=>n("path",{d:"M83.782 584.183v-71.308L239.82 399.518l43.771 60.249-120.888 87.822 126.008 84.992-41.64 61.747-163.29-110.145z m856.567-74.529v71.308l-156.03 113.366-43.78-60.249 120.887-87.83-126.008-84.993 41.65-61.738 163.28 110.136z",fill:"#D8D8D8","p-id":"7512"},null,-1)),co=[so,no,ro,io],uo=le(()=>n("p",{class:"message"},"开发中，敬请期待",-1));function po(e,o,r,p,a,s){return i(),f("div",lo,[(i(),f("svg",ao,co)),uo])}const ho=V(oo,[["render",po],["__scopeId","data-v-f339855d"]]),_o={name:"DevelopmentPage"},ae=e=>(T("data-v-e5749ebd"),e=e(),M(),e),mo={class:"development-page"},fo={class:"icon",style:{width:"6em",height:"6em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7508"},go=ae(()=>n("path",{d:"M443.83 908.912c21.615 0 32.265-7.876 35.84-17.082 33.996-87.822 95.837-525.508 120.44-573.152 23.404-45.335 78.271-43.818 164.595 4.543a9.31 9.31 0 0 0 13.153-4.562l43.474-104.95a4.971 4.971 0 0 0-2.365-6.349c-73.886-37.153-159.65-58.415-251.112-58.415-58.182 0-114.065 8.602-166.037 24.428-59.644 18.152-99.933 48.407-127.135 87.095-2.448 3.491-3.872 12.903 5.79 12.903 25.787 0 97.476-12.903 123.393-17.064 26-4.17 70.032-11.785 79.527 21.579 12.493 43.948-58.647 312.18-81.575 381.56-22.985 69.502-41.9 141.331-51.182 180.597-2.448 10.333 0 32.703 12.046 42.636 11.776 9.681 50.409 26.233 81.148 26.233z",fill:"#FFAE00","p-id":"7509"},null,-1)),bo=ae(()=>n("path",{d:"M781.898 175.523l68.553 29.1-60.156 141.703-68.552-29.09z",fill:"#D8D8D8","p-id":"7510"},null,-1)),vo=ae(()=>n("path",{d:"M443.83 908.912c21.615 0 32.265-7.876 35.84-17.082 15.304-39.564 44.301-182.542 86.974-428.945l-104.187-32.377c-31.874 126.762-52.094 203.078-60.64 228.939-22.984 69.501-41.9 141.33-51.18 180.596-2.45 10.333 0 32.703 12.045 42.636 11.776 9.681 50.409 26.233 81.148 26.233z",fill:"#42434D","p-id":"7511"},null,-1)),yo=ae(()=>n("path",{d:"M83.782 584.183v-71.308L239.82 399.518l43.771 60.249-120.888 87.822 126.008 84.992-41.64 61.747-163.29-110.145z m856.567-74.529v71.308l-156.03 113.366-43.78-60.249 120.887-87.83-126.008-84.993 41.65-61.738 163.28 110.136z",fill:"#D8D8D8","p-id":"7512"},null,-1)),Do=[go,bo,vo,yo],wo=ae(()=>n("p",{class:"message"},"开发中，敬请期待",-1));function xo(e,o,r,p,a,s){return i(),f("div",mo,[(i(),f("svg",fo,Do)),wo])}const zo=V(_o,[["render",xo],["__scopeId","data-v-e5749ebd"]]),Fo={name:"DevelopmentPage"},se=e=>(T("data-v-3b5aafb5"),e=e(),M(),e),Co={class:"development-page"},ko={class:"icon",style:{width:"6em",height:"6em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7508"},So=se(()=>n("path",{d:"M443.83 908.912c21.615 0 32.265-7.876 35.84-17.082 33.996-87.822 95.837-525.508 120.44-573.152 23.404-45.335 78.271-43.818 164.595 4.543a9.31 9.31 0 0 0 13.153-4.562l43.474-104.95a4.971 4.971 0 0 0-2.365-6.349c-73.886-37.153-159.65-58.415-251.112-58.415-58.182 0-114.065 8.602-166.037 24.428-59.644 18.152-99.933 48.407-127.135 87.095-2.448 3.491-3.872 12.903 5.79 12.903 25.787 0 97.476-12.903 123.393-17.064 26-4.17 70.032-11.785 79.527 21.579 12.493 43.948-58.647 312.18-81.575 381.56-22.985 69.502-41.9 141.331-51.182 180.597-2.448 10.333 0 32.703 12.046 42.636 11.776 9.681 50.409 26.233 81.148 26.233z",fill:"#FFAE00","p-id":"7509"},null,-1)),Vo=se(()=>n("path",{d:"M781.898 175.523l68.553 29.1-60.156 141.703-68.552-29.09z",fill:"#D8D8D8","p-id":"7510"},null,-1)),$o=se(()=>n("path",{d:"M443.83 908.912c21.615 0 32.265-7.876 35.84-17.082 15.304-39.564 44.301-182.542 86.974-428.945l-104.187-32.377c-31.874 126.762-52.094 203.078-60.64 228.939-22.984 69.501-41.9 141.33-51.18 180.596-2.45 10.333 0 32.703 12.045 42.636 11.776 9.681 50.409 26.233 81.148 26.233z",fill:"#42434D","p-id":"7511"},null,-1)),Io=se(()=>n("path",{d:"M83.782 584.183v-71.308L239.82 399.518l43.771 60.249-120.888 87.822 126.008 84.992-41.64 61.747-163.29-110.145z m856.567-74.529v71.308l-156.03 113.366-43.78-60.249 120.887-87.83-126.008-84.993 41.65-61.738 163.28 110.136z",fill:"#D8D8D8","p-id":"7512"},null,-1)),To=[So,Vo,$o,Io],Mo=se(()=>n("p",{class:"message"},"开发中，敬请期待",-1));function Ro(e,o,r,p,a,s){return i(),f("div",Co,[(i(),f("svg",ko,To)),Mo])}const Uo=V(Fo,[["render",Ro],["__scopeId","data-v-3b5aafb5"]]),Bo={data(){return{selectedFile:null,uploadUrl:"/stu/uploadExcel"}},methods:{submitUpload(){this.$nextTick(()=>{this.$refs.upload.submit()})},handleChange(e,o){if(e.status==="success"){const r=this.selectedFile||e.raw;console.log("userSelectedFile:",r);const p=new FormData;p.append("file",r),D.post(this.uploadUrl,p).then(a=>this.handleRequestSuccess(a)).catch(a=>this.handleRequestError(a))}},handleRequestSuccess(e){console.log("请求成功：",e)},handleRequestError(e){console.error("请求失败：",e)},beforeUpload(e){const o=e.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";return o?(this.selectedFile=e.raw,console.log("this.selectedFile:",this.selectedFile)):this.$message.error("只能上传xlsx文件"),o},refreshTable(){D.get("/stu/upload").then(e=>this.handleRefreshSuccess(e)).catch(e=>this.handleRefreshError(e))},fixScoreEngine(){D.get("/score/fix").then(e=>this.handleRefreshSuccess(e)).catch(e=>this.handleRefreshError(e))},handleRefreshSuccess(e){e.code===200?this.$message.success("学生表刷新成功，已采用最新上传表格"):this.$message.error("刷新失败："+e.message)},handleRefreshError(e){console.error("刷新失败：",e)},confirmRefresh(){R.confirm("刷新后，旧表格数据将被删除，此操作不可逆！","确认刷新",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.refreshTable()}).catch(()=>{})},fixScore(){R.confirm("此操作可以修复重新上传名册导致的分数归位","确认刷新",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.fixScoreEngine(),this.$message.success("修正完毕")}).catch(()=>{})}}},Ve=e=>(T("data-v-fab38b76"),e=e(),M(),e),Eo=Ve(()=>n("div",{class:"el-upload__tip"},"只能上传*.xlsx文件",-1)),Ho=Ve(()=>n("div",{class:"el-upload__tip"},"重新上传学生名册后，需要使用“修正分数”功能对之前的德育分操作进行恢复",-1));function Ao(e,o,r,p,a,s){const c=d("el-button"),_=d("el-upload");return i(),f("div",null,[t(_,{class:"upload-demo",action:a.uploadUrl,headers:{Authorization:e.token},"on-change":s.handleChange,"before-upload":s.beforeUpload,ref:"upload"},{default:l(()=>[t(c,{size:"medium",type:"primary",onClick:s.submitUpload,class:"upload-button"},{default:l(()=>[m(" 上传文件 ")]),_:1},8,["onClick"])]),_:1},8,["action","headers","on-change","before-upload"]),Eo,Ho,t(c,{size:"medium",type:"danger",plain:"",onClick:s.confirmRefresh,class:"refresh-button"},{default:l(()=>[m(" 刷新表格 ")]),_:1},8,["onClick"]),t(c,{size:"medium",type:"primary",plain:"",onClick:s.fixScore,class:"refresh-button"},{default:l(()=>[m(" 修正分数 ")]),_:1},8,["onClick"])])}const Po=V(Bo,[["render",Ao],["__scopeId","data-v-fab38b76"]]),Lo=e=>D.get("/stu",{params:e}),No={components:{ElTable:W,ElTableColumn:J,ElPagination:he,ElButton:Q,ElDrawer:Re},data(){return{tableData:[],visibleColumns:[],showModify:!0,originalFormData:{},detailFormData:{stuId:"暂无数据",stuName:"暂无数据",grade:"暂无数据",subject:"暂无数据",clazz:"暂无数据",gender:"暂无数据",phone:"暂无数据",idCard:"暂无数据",ethnicity:"暂无数据",poli:"暂无数据",apartment:"暂无数据",room:"暂无数据",attendanceStatus:"暂无数据",enrollmentStatus:"暂无数据",birthplace:"暂无数据",home:"暂无数据",homeFull:"暂无数据",sosPhone:"暂无数据",sosRel:"暂无数据",score:"暂无数据",score2:"暂无数据",isSpecial:"暂无数据",createTime:"暂无数据",updateTime:"暂无数据",note:"暂无数据"},tableColumns:[{label:"学号",prop:"stuId"},{label:"姓名",prop:"stuName"},{label:"年级",prop:"grade"},{label:"专业",prop:"subject"},{label:"班级",prop:"clazz"},{label:"性别",prop:"gender"},{label:"电话号码",prop:"phone"},{label:"身份证号",prop:"idCard"},{label:"民族",prop:"ethnicity"},{label:"政治面貌",prop:"poli"},{label:"所在公寓",prop:"apartment"},{label:"所在寝室",prop:"room"},{label:"走读状态",prop:"attendanceStatus"},{label:"学籍状态",prop:"enrollmentStatus"},{label:"籍贯",prop:"birthplace"},{label:"家庭地址",prop:"home"},{label:"完整家庭地址",prop:"homeFull"},{label:"紧急联系人手机号码",prop:"sosPhone"},{label:"与紧急联系人关系",prop:"sosRel"},{label:"德育分",prop:"score"},{label:"第二课堂积分",prop:"score2"},{label:"特殊学生",prop:"isSpecial"},{label:"记录创建时间",prop:"createTime"},{label:"记录更新时间",prop:"updateTime"},{label:"备注",prop:"note"}],pageSize:30,total:100,currentPage:1,grade:"",clazz:"",stu_id:"",stu_name:"",detailDrawerVisible:!1,isEditing:!1}},methods:{async fetchData(){try{const o=(await D.get("/users/role")).data;this.showModify=o<11;const r={pageNum:this.currentPage,pageSize:this.pageSize,grade:this.grade,clazz:this.clazz,stu_id:this.stu_id,stu_name:this.stu_name},a=(await Lo(r)).data;this.tableData=a.current_item,this.total=a.total,this.visibleColumns=this.tableColumns.filter(s=>this.tableData.map(_=>_[s.prop]).some(_=>_!==null))}catch(e){console.error("请求数据失败:",e)}},handleSizeChange(e){this.pageSize=e,this.fetchData()},handleCurrentChange(e){this.currentPage=e,this.fetchData()},search(){this.currentPage=1,this.fetchData()},async showDetailDialog(e){const p={stu_id:e,stu_name:null};try{const s=(await D.get("/stu/search",{params:p})).data;if(Array.isArray(s)&&s.length>0){const c=Object.keys(s[0]).map(g=>{const y=s[0][g]?s[0][g].value:"暂无数据";return{label:s[0][g]?s[0][g].label:g,prop:g,value:y}}),_={stuUid:"系统内编号",stuId:"学号",stuName:"姓名",grade:"年级",groupType:"学历组",subject:"专业",clazz:"班级",gender:"性别",phone:"电话号码",idCard:"身份证号",ethnicity:"民族",poli:"政治面貌",apartment:"所在公寓",room:"所在寝室",attendanceStatus:"走读状态",enrollmentStatus:"学籍状态",birthplace:"籍贯",home:"家庭地址",homeFull:"完整家庭地址",sosPhone:"紧急联系人手机号码",sosRel:"与紧急联系人关系",score:"德育分",score2:"第二课堂积分",isSpecial:"特殊学生",createTime:"记录创建时间",updateTime:"记录更新时间",note:"备注"},v=c.map(g=>({label:_[g.prop]||g.label,prop:g.prop,value:g.value}));this.detailTableData=v;const w={};v.forEach(g=>{w[g.prop]=g.value}),this.detailFormData=s[0],this.detailDrawerVisible=!0,this.originalFormData={...this.detailFormData}}else console.error("接口返回数据格式不符合预期")}catch(a){console.error("请求详情数据失败:",a)}},closeDetailDrawer(){this.detailDrawerVisible=!1},startEditing(){this.isEditing=!0},columnVisible(e){return e==="操作"?this.showModify:!0},async submitChanges(){try{const e={stuId:this.detailFormData.stuId,stuName:this.detailFormData.stuName,grade:this.detailFormData.grade,groupType:this.detailFormData.groupType,subject:this.detailFormData.subject,clazz:this.detailFormData.clazz,gender:this.detailFormData.gender,phone:this.detailFormData.phone,idCard:this.detailFormData.idCard,ethnicity:this.detailFormData.ethnicity,poli:this.detailFormData.poli,apartment:this.detailFormData.apartment,room:this.detailFormData.room,attendanceStatus:this.detailFormData.attendanceStatus,enrollmentStatus:this.detailFormData.enrollmentStatus,birthplace:this.detailFormData.birthplace,home:this.detailFormData.home,homeFull:this.detailFormData.homeFull,sosPhone:this.detailFormData.sosPhone,sosRel:this.detailFormData.sosRel,score:this.detailFormData.score,score2:this.detailFormData.score2,isSpecial:this.detailFormData.isSpecial,note:this.detailFormData.note};await this.updateStudentInfo(e),this.isEditing=!1,this.$message.success("修改成功"),console.log("开始刷新数据"),this.fetchData()}catch(e){console.error("提交修改失败:",e),this.$message.success("更新失败")}},cancelEditing(){this.detailFormData.stuId=this.originalFormData.stuId,this.detailFormData.stuName=this.originalFormData.stuName,this.detailFormData.grade=this.originalFormData.grade,this.detailFormData.groupType=this.originalFormData.groupType,this.detailFormData.subject=this.originalFormData.subject,this.detailFormData.clazz=this.originalFormData.clazz,this.detailFormData.gender=this.originalFormData.gender,this.detailFormData.phone=this.originalFormData.phone,this.detailFormData.idCard=this.originalFormData.idCard,this.detailFormData.ethnicity=this.originalFormData.ethnicity,this.detailFormData.poli=this.originalFormData.poli,this.detailFormData.apartment=this.originalFormData.apartment,this.detailFormData.room=this.originalFormData.room,this.detailFormData.attendanceStatus=this.originalFormData.attendanceStatus,this.detailFormData.enrollmentStatus=this.originalFormData.enrollmentStatus,this.detailFormData.birthplace=this.originalFormData.birthplace,this.detailFormData.home=this.originalFormData.home,this.detailFormData.homeFull=this.originalFormData.homeFull,this.detailFormData.sosPhone=this.originalFormData.sosPhone,this.detailFormData.sosRel=this.originalFormData.sosRel,this.detailFormData.score=this.originalFormData.score,this.detailFormData.score2=this.originalFormData.score2,this.detailFormData.isSpecial=this.originalFormData.isSpecial,this.detailFormData.createTime=this.originalFormData.createTime,this.detailFormData.updateTime=this.originalFormData.updateTime,this.detailFormData.note=this.originalFormData.note,this.isEditing=!1},async updateStudentInfo(e){try{await D.post("/stu/update",e),console.log("更新成功")}catch(o){console.error("更新失败:",o)}},async handleDelete(e){try{await this.$confirm("此操作不可逆！确定删除该学生数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})==="confirm"&&(await this.deleteStudent(e),this.$message.success("删除成功"),this.detailDrawerVisible=!1,this.fetchData())}catch(o){console.error("删除学生数据失败:",o),this.$message.info("已取消操作")}},async deleteStudent(e){try{await D.post("/stu/delete",e)}catch(o){throw console.error("调用删除接口失败:",o),o}}},mounted(){this.fetchData()}},jo=e=>(T("data-v-2bbd8b3e"),e=e(),M(),e),Oo=jo(()=>n("div",{class:"header"},null,-1)),Ko={style:{fontSize:"12px"}};function qo(e,o,r,p,a,s){const c=d("el-input"),_=d("el-form-item"),v=d("el-button"),w=d("el-form"),g=d("el-table-column"),y=d("el-table"),x=d("el-pagination"),h=d("el-col"),u=d("el-row"),k=d("el-popconfirm"),q=d("el-drawer"),Y=d("el-card");return i(),b(Y,{class:"page-container"},{default:l(()=>[Oo,t(w,{inline:""},{default:l(()=>[t(_,{label:"年级"},{default:l(()=>[t(c,{modelValue:a.grade,"onUpdate:modelValue":o[0]||(o[0]=F=>a.grade=F),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"请输入年级"},null,8,["modelValue","onKeyup","onBlur"])]),_:1}),t(_,{label:"班级"},{default:l(()=>[t(c,{modelValue:a.clazz,"onUpdate:modelValue":o[1]||(o[1]=F=>a.clazz=F),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"请输入班级"},null,8,["modelValue","onKeyup","onBlur"])]),_:1}),t(_,{label:"学号"},{default:l(()=>[t(c,{modelValue:a.stu_id,"onUpdate:modelValue":o[2]||(o[2]=F=>a.stu_id=F),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"请输入学号"},null,8,["modelValue","onKeyup","onBlur"])]),_:1}),t(_,{label:"姓名"},{default:l(()=>[t(c,{modelValue:a.stu_name,"onUpdate:modelValue":o[3]||(o[3]=F=>a.stu_name=F),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"请输入姓名"},null,8,["modelValue","onKeyup","onBlur"])]),_:1}),t(_,null,{default:l(()=>[t(v,{type:"primary",onClick:s.search},{default:l(()=>[m("搜索")]),_:1},8,["onClick"]),t(v,{onClick:e.resetSearch},{default:l(()=>[m("重置")]),_:1},8,["onClick"])]),_:1})]),_:1}),t(y,{data:a.tableData,style:{width:"100%"},"show-overflow-tooltip":"","cell-style":{textAlign:"center"},"header-cell-style":{textAlign:"center"}},{default:l(()=>[(i(!0),f(E,null,H(a.visibleColumns,F=>(i(),b(g,{key:F.prop,prop:F.prop,label:F.label},{default:l(({row:U})=>[n("div",Ko,$(U[F.prop]),1)]),_:2},1032,["prop","label"]))),128)),t(g,{fixed:"left",label:"操作",width:"100"},{default:l(({row:F})=>[t(v,{type:"text",onClick:U=>s.showDetailDialog(F.stuId)},{default:l(()=>[m("详情")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a.total>a.pageSize?(i(),b(x,{key:0,onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange,"page-sizes":[10,30,50,100],"page-size":a.pageSize,total:a.total,layout:"sizes, prev, pager, next, jumper"},null,8,["onSizeChange","onCurrentChange","page-size","total"])):S("",!0),t(q,{modelValue:a.detailDrawerVisible,"onUpdate:modelValue":o[5]||(o[5]=F=>a.detailDrawerVisible=F),title:"学生详情",direction:"rtl",size:"50%"},{default:l(()=>[t(w,{model:a.detailFormData,"label-width":"170px"},{default:l(()=>[e.detailTableData.length>0?(i(),b(u,{key:0},{default:l(()=>[(i(!0),f(E,null,H(e.detailTableData,(F,U)=>(i(),b(h,{span:12,key:U},{default:l(()=>[t(_,{label:F.label,prop:F.prop},{default:l(()=>[F.value!==null?(i(),b(c,{key:0,modelValue:a.detailFormData[F.prop],"onUpdate:modelValue":ce=>a.detailFormData[F.prop]=ce,placeholder:F.label,readonly:!a.isEditing,disabled:["stuId","stuUid","createTime","updateTime","score","score2"].includes(F.prop),class:"short-input"},null,8,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled"])):(i(),b(c,{key:1,placeholder:F.label,readonly:!a.isEditing,disabled:["stuId","stuUid","createTime","updateTime","score","score2"].includes(F.prop),class:"short-input"},null,8,["placeholder","readonly","disabled"]))]),_:2},1032,["label","prop"])]),_:2},1024))),128))]),_:1})):S("",!0)]),_:1},8,["model"]),a.showModify?de((i(),b(v,{key:0,type:"primary",onClick:s.startEditing},{default:l(()=>[m("修改")]),_:1},8,["onClick"])),[[ue,!a.isEditing]]):S("",!0),a.showModify?S("",!0):de((i(),b(v,{key:1,disabled:"",type:"primary",onClick:s.startEditing},{default:l(()=>[m("无权限修改")]),_:1},8,["onClick"])),[[ue,!a.isEditing]]),de(t(v,{onClick:s.submitChanges},{default:l(()=>[m("提交")]),_:1},8,["onClick"]),[[ue,a.isEditing]]),de(t(v,{onClick:s.cancelEditing},{default:l(()=>[m("取消")]),_:1},8,["onClick"]),[[ue,a.isEditing]]),t(k,{title:"确认要删除该学生数据吗？","confirm-button-text":"确认","cancel-button-text":"取消",onConfirm:o[4]||(o[4]=F=>s.handleDelete(a.detailFormData.stuId))},{reference:l(()=>[t(v,{text:"",bg:"",type:"danger"},{default:l(()=>[m("删除")]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const Yo=V(No,[["render",qo],["__scopeId","data-v-2bbd8b3e"]]),Go={data(){return{}},methods:{async exportRoster(){try{({code:200}).code===200&&(I.success("正在导出，请稍后..."),setTimeout(()=>{I.success("导出成功，即将开始下载..."),te(1)},2e3))}catch(e){console.error("Error exporting roster:",e)}}}},ne=e=>(T("data-v-a69e6bc8"),e=e(),M(),e),Zo={class:"export-roster-container"},Xo={class:"development-page"},Wo={class:"icon",style:{width:"8em",height:"8em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5721"},Jo=ne(()=>n("path",{d:"M96 96h640l192 192v640H96z",fill:"#FFFFFF","p-id":"5722"},null,-1)),Qo=ne(()=>n("path",{d:"M384 544v32H256v320h128v32H96V96h640l192 192v160h-32V301.248l-160-160V384H288V128H128v768h96V544h160zM320 128v224h384V128H320z",fill:"#5D6D7E","p-id":"5723"},null,-1)),el=ne(()=>n("path",{d:"M320 640h64v32h-64v-32z m0 96h64v32h-64v-32z",fill:"#ACB4C0","p-id":"5724"},null,-1)),tl=ne(()=>n("path",{d:"M544 160h96v160h-96z",fill:"#3B97D3","p-id":"5725"},null,-1)),ol=ne(()=>n("path",{d:"M736 928v32l-288-66.56V539.104L736 480v32h192a32 32 0 0 1 32 32v352a32 32 0 0 1-32 32h-192z m0-32h192V544h-192v352z m-224-95.68h38.816l35.68-55.424 38.72 59.968 39.872 0.48-58.816-87.456 54.624-83.2-39.68 0.736-34.08 56.096L554.976 640h-37.824l49.632 76.672L512 800.352zM736 576h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m96-256h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z",fill:"#1E7144","p-id":"5726"},null,-1)),ll=[Jo,Qo,el,tl,ol];function al(e,o,r,p,a,s){const c=d("el-button");return i(),f("div",Zo,[n("div",Xo,[(i(),f("svg",Wo,ll))]),t(c,{class:"export-button",onClick:s.exportRoster},{default:l(()=>[m("导出名册")]),_:1},8,["onClick"])])}const sl=V(Go,[["render",al],["__scopeId","data-v-a69e6bc8"]]),nl={data(){return{selectedFile:null,uploadUrl:"/rec/upload",activeStep:0}},methods:{submitUpload(){this.$nextTick(()=>{this.$refs.upload.submit()})},handleChange(e,o){if(e.status==="success"){const r=this.selectedFile||e.raw;console.log("userSelectedFile:",r);const p=new FormData;p.append("file",r),D.post(this.uploadUrl,p).then(a=>{this.handleRequestSuccess(a),this.activeStep=1}).catch(a=>this.handleRequestError(a))}},handleRequestSuccess(e){console.log("请求成功：",e)},handleRequestError(e){console.error("请求失败：",e)},beforeUpload(e){const o=e.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";return o?(this.selectedFile=e.raw,console.log("this.selectedFile:",this.selectedFile)):this.$message.error("只能上传xlsx文件"),o},importTable(){D.get("/rec/upload").then(e=>{this.handleRefreshSuccess(e),this.activeStep=2}).catch(e=>this.handleRefreshError(e))},refreshTable(){D.get("/rec/refresh").then(e=>{this.handleRefreshSuccess(e),this.activeStep=3}).catch(e=>this.handleRefreshError(e))},handleRefreshSuccess(e){e.code===200?this.$message.success("德育分表已载入完毕！"):this.$message.error("载入失败："+e.message)},async downloadModel(){try{({code:200}).code===200&&(this.$message.success("请稍后..."),setTimeout(()=>{this.$message.success("即将开始下载..."),te(2)},2e3))}catch(e){console.error("Error exporting roster:",e)}},handleRefreshError(e){console.error("刷新失败：",e)},confirmImport(){R.confirm("刷新后分数将变为“审核中”状态！","确认刷新",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.importTable()}).catch(()=>{})},confirmRefresh(){R.confirm("刷新后，分数操作将生效。如需撤销请前往记录查询页面","确认刷新",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.refreshTable()}).catch(()=>{})}}},rl=e=>(T("data-v-bbf72487"),e=e(),M(),e),il=rl(()=>n("div",{class:"el-upload__tip"},"只能上传*.xlsx文件",-1));function cl(e,o,r,p,a,s){const c=d("el-step"),_=d("el-steps"),v=d("el-button"),w=d("el-upload");return i(),f("div",null,[t(_,{class:"steps-container",active:a.activeStep,"align-center":"","finish-status":"success",simple:""},{default:l(()=>[t(c,{title:"上传",icon:e.UploadFilled},null,8,["icon"]),t(c,{title:"导入",icon:e.Tools},null,8,["icon"]),t(c,{title:"通过审核",icon:e.Check},null,8,["icon"])]),_:1},8,["active"]),t(w,{class:"upload-demo",action:a.uploadUrl,headers:{Authorization:e.token},"on-change":s.handleChange,"before-upload":s.beforeUpload,ref:"upload"},{default:l(()=>[t(v,{size:"medium",type:"primary",onClick:s.submitUpload,class:"upload-button"},{default:l(()=>[m(" 上传文件 ")]),_:1},8,["onClick"])]),_:1},8,["action","headers","on-change","before-upload"]),il,t(v,{size:"medium",type:"info",plain:"",onClick:s.downloadModel,class:"refresh-button"},{default:l(()=>[m(" 下载模板 ")]),_:1},8,["onClick"]),t(v,{size:"medium",type:"primary",plain:"",onClick:s.confirmImport,class:"refresh-button"},{default:l(()=>[m(" 导入数据 ")]),_:1},8,["onClick"]),t(v,{size:"medium",type:"success",plain:"",onClick:s.confirmRefresh,class:"refresh-button"},{default:l(()=>[m(" 通过审核 ")]),_:1},8,["onClick"])])}const dl=V(nl,[["render",cl],["__scopeId","data-v-bbf72487"]]),ul=e=>D.get("/rec",{params:e}),pl=async e=>{try{return(await D.get("/rec/search",{params:e})).data}catch(o){throw console.error("请求表格数据失败:",o),o}},hl=async e=>{try{return(await D.get("/score/search",{params:{stuId:e}})).data}catch(o){throw console.error("请求分数数据失败:",o),o}},_l={components:{ElTable:W,ElTableColumn:J,ElPagination:he,ElInput:_e,ElButton:Q,ElTag:me},data(){return{tableData:[],tableColumns:[{label:"ID",prop:"opr_id"},{label:"学号",prop:"opr_target_stu"},{label:"姓名",prop:"stu_name"},{label:"操作分数",prop:"opr_score"},{label:"操作后分数",prop:"target_stu_score"},{label:"原因",prop:"opr_reason"},{label:"时间",prop:"oprTime"},{label:"状态",prop:"status"}],pageSize:30,total:100,currentPage:1,stu_id:"",opr_time:""}},methods:{getStatusTagType(e){switch(e){case 1:return"success";case 2:return"primary";case 0:return"danger";case 8:return"info";default:return"black"}},getStatusText(e){switch(e){case 1:return"有效";case 0:return"已撤销";case 2:return"系统锁定";case 8:return"审核中";default:return e}},async fetchData(){const e={pageNum:this.currentPage,pageSize:this.pageSize,stu_id:this.stu_id,opr_time:this.opr_time},r=(await ul(e)).data;console.log("接口返回的数据:",r),this.tableData=r.current_item,this.total=r.total},handleSizeChange(e){this.pageSize=e,this.fetchData()},handleCurrentChange(e){this.currentPage=e,this.fetchData()},search(){this.currentPage=1,this.fetchData()},async handleUndo(e){if(e.status!==1){R.alert("当前记录无法撤销","提示",{confirmButtonText:"确定",type:"warning"});return}try{if(await R.confirm("确定要执行撤销操作吗？（撤销操作不可逆，同时会生成一条锁定的撤销操作数据）","确认撤销",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})){const r=await D.post("/rec/undo",{opr_id:e.opr_id});R.alert("撤销成功","提示",{confirmButtonText:"确定",type:"success"}),this.fetchData()}}catch{R.alert("已取消撤销操作","提示",{confirmButtonText:"确定",type:"error"})}}},mounted(){this.fetchData()}},ml={class:"search-container"},fl={key:0},gl={key:2};function bl(e,o,r,p,a,s){const c=d("el-input"),_=d("el-button"),v=d("el-tag"),w=d("el-table-column"),g=d("el-table"),y=d("el-pagination"),x=d("el-card");return i(),b(x,{class:"page-container"},{default:l(()=>[n("div",null,[n("div",ml,[t(c,{modelValue:a.stu_id,"onUpdate:modelValue":o[0]||(o[0]=h=>a.stu_id=h),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"学号",class:"search-input"},null,8,["modelValue","onKeyup","onBlur"]),t(c,{modelValue:a.opr_time,"onUpdate:modelValue":o[1]||(o[1]=h=>a.opr_time=h),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"操作时间(YYYY-MM-DD)",class:"search-input"},null,8,["modelValue","onKeyup","onBlur"]),t(_,{type:"primary",onClick:s.search},{default:l(()=>[m("搜索")]),_:1},8,["onClick"])]),t(g,{data:a.tableData,border:"",stripe:"",style:{width:"100%","white-space":"nowrap"},height:e.tableHeight,"show-overflow-tooltip":"","cell-style":{textAlign:"center"},"header-cell-style":{textAlign:"center"},fit:!0},{default:l(()=>[(i(!0),f(E,null,H(a.tableColumns,h=>(i(),b(w,{key:h.prop,prop:h.prop,label:h.label},{default:l(({row:u})=>[h.prop==="status"?(i(),f("div",fl,[t(v,{type:s.getStatusTagType(u[h.prop]),class:"status-tag"},{default:l(()=>[m($(s.getStatusText(u[h.prop])),1)]),_:2},1032,["type"])])):h.prop==="opr_score"?(i(),f("span",{key:1,style:X({"font-weight":"bold",color:u[h.prop]>=0?"green":"red"})},$(u[h.prop]),5)):(i(),f("span",gl,$(u[h.prop]),1))]),_:2},1032,["prop","label"]))),128)),t(w,{label:"操作"},{default:l(({row:h})=>[t(_,{type:"danger",onClick:u=>s.handleUndo(h),plain:"",class:"undo-button"},{default:l(()=>[m("撤销")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","height"]),a.total>a.pageSize?(i(),b(y,{key:0,onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange,"page-sizes":[10,30,50,100],"page-size":a.pageSize,total:a.total,layout:"sizes, prev, pager, next, jumper"},null,8,["onSizeChange","onCurrentChange","page-size","total"])):S("",!0)])]),_:1})}const vl=V(_l,[["render",bl],["__scopeId","data-v-317948ca"]]),yl={data(){return{}},methods:{async exportRoster(){try{({code:200}).code===200&&(I.success("正在导出，请稍后..."),setTimeout(()=>{I.success("导出成功，即将开始下载..."),te(3)},2e3))}catch(e){console.error("Error exporting roster:",e)}}}},re=e=>(T("data-v-970ef7e5"),e=e(),M(),e),Dl={class:"export-roster-container"},wl={class:"development-page"},xl={class:"icon",style:{width:"8em",height:"8em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5721"},zl=re(()=>n("path",{d:"M96 96h640l192 192v640H96z",fill:"#FFFFFF","p-id":"5722"},null,-1)),Fl=re(()=>n("path",{d:"M384 544v32H256v320h128v32H96V96h640l192 192v160h-32V301.248l-160-160V384H288V128H128v768h96V544h160zM320 128v224h384V128H320z",fill:"#5D6D7E","p-id":"5723"},null,-1)),Cl=re(()=>n("path",{d:"M320 640h64v32h-64v-32z m0 96h64v32h-64v-32z",fill:"#ACB4C0","p-id":"5724"},null,-1)),kl=re(()=>n("path",{d:"M544 160h96v160h-96z",fill:"#3B97D3","p-id":"5725"},null,-1)),Sl=re(()=>n("path",{d:"M736 928v32l-288-66.56V539.104L736 480v32h192a32 32 0 0 1 32 32v352a32 32 0 0 1-32 32h-192z m0-32h192V544h-192v352z m-224-95.68h38.816l35.68-55.424 38.72 59.968 39.872 0.48-58.816-87.456 54.624-83.2-39.68 0.736-34.08 56.096L554.976 640h-37.824l49.632 76.672L512 800.352zM736 576h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m96-256h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z",fill:"#1E7144","p-id":"5726"},null,-1)),Vl=[zl,Fl,Cl,kl,Sl];function $l(e,o,r,p,a,s){const c=d("el-button");return i(),f("div",Dl,[n("div",wl,[(i(),f("svg",xl,Vl))]),t(c,{class:"export-button",onClick:s.exportRoster},{default:l(()=>[m("导出德育分表")]),_:1},8,["onClick"])])}const Il=V(yl,[["render",$l],["__scopeId","data-v-970ef7e5"]]),Tl={data(){return{categories:[{name:"学工",buttons:[{text:"教务系统（校内）",link:"http://cdjwc.ccu.edu.cn/jsxsd"},{text:"教务系统（VPN）",link:"https://cdjwc.webvpn.ccu.edu.cn/"},{text:"辅导猫",link:"https://cat.wisedu.com/"},{text:"学工系统（VPN）",link:"http://stu.ccu.edu.cn/"},{text:"惠就业（校）",link:"http://college.hjiuye.com/"},{text:"智慧就业云平台（省）",link:"https://zhjy.jilinjobs.cn:8080/"},{text:"医保平台",link:"https://smsc.hs.ybj.jl.gov.cn:18443/schoolCenterLocal/#/login?redirect=%2FHomeIndex"},{text:"学生端-德育分查询",link:".#/v1/search"}]},{name:"官网",buttons:[{text:"长春大学教育信息网",link:"https://jwc.ccu.edu.cn/"},{text:"长春大学官网",link:"https://www.ccu.edu.cn/"},{text:"长春大学计算机科学技术学院",link:"https://cst.ccu.edu.cn/"},{text:"长春大学学工处",link:"https://cdxgc.ccu.edu.cn/"}]}]}},methods:{openLink(e){window.open(e,"_blank")},generateRandomColor(){const e="0123456789ABCDEF";let o="#";for(let r=0;r<6;r++)o+=e[Math.floor(Math.random()*16)];return o+"20"}}},Ml={class:"button-grid"},Rl={class:"category-header"},Ul={class:"buttons"};function Bl(e,o,r,p,a,s){const c=d("el-divider"),_=d("el-button");return i(),f("div",Ml,[(i(!0),f(E,null,H(a.categories,(v,w)=>(i(),f("div",{key:w,class:"category"},[n("div",Rl,$(v.name),1),t(c),n("div",Ul,[(i(!0),f(E,null,H(v.buttons,(g,y)=>(i(),b(_,{key:y,type:"primary",onClick:x=>s.openLink(g.link),class:"custom-button",style:X({background:s.generateRandomColor()})},{default:l(()=>[m($(g.text),1)]),_:2},1032,["onClick","style"]))),128))])]))),128))])}const El=V(Tl,[["render",Bl]]),Hl="/api",Al=fe.create({baseURL:Hl}),Pl="/api/files/pullFile",we=K("");Al.interceptors.request.use(e=>{const o=ee();return console.log("Setting Authorization header:",o.token),o.token&&(e.headers.Authorization=o.token),e},e=>Promise.reject(e));const Ll={data(){return{selectedFile:null,uploadUrl:"/files/upload",fileList:[],pageSize:30,total:100,currentPage:1,fileName:""}},mounted(){this.refreshFileList()},methods:{submitUpload(){this.$nextTick(()=>{this.$refs.upload.submit()})},handleChange(e,o){if(e.status==="success"){const r=this.selectedFile||e.raw;console.log("userSelectedFile:",r);const p=new FormData;p.append("file",r),D.post(this.uploadUrl,p).then(a=>this.handleRequestSuccess(a)).catch(a=>this.handleRequestError(a))}},handleRequestSuccess(e){console.log("请求成功：",e),this.refreshFileList()},handleRequestError(e){console.error("请求失败：",e)},refreshFileList(){const e={pageNum:this.currentPage,pageSize:this.pageSize,file_name:this.fileName};D.get("/files/list",{params:e}).then(o=>{const r=o.data;this.fileList=r.current_item,this.total=r.total}).catch(o=>{console.error("获取文件列表失败：",o)})},handleDownload(e){try{({code:200}).code===200&&(I.success("请稍后..."),setTimeout(()=>{I.success("即将开始下载..."),we.value=`${Pl}?file_id=${e}`,console.log(we.value);let p=ee().token;return fe({method:"get",url:we.value,headers:{Authorization:p},responseType:"blob"}).then(function(a){if(a.headers["content-disposition"]!==void 0){let s=new Blob([a.data],{type:"application/vnd.ms-excel;charset=utf-8"}),c=decodeURI(a.headers["content-disposition"]);c&&(c=c.substring(c.indexOf("=")+1));const _=document.createElement("a");_.download=c,_.style.display="none",_.href=URL.createObjectURL(s),document.body.appendChild(_),_.click(),URL.revokeObjectURL(_.href),document.body.removeChild(_)}})},2e3))}catch(o){console.error("Error exporting roster:",o)}},search(){this.currentPage=1,this.refreshFileList()},handleDelete(e){R.confirm("确定要删除该文件吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D.post(`/files/delete?file_id=${e}`).then(o=>{console.log("删除成功：",o),this.refreshFileList(),I.success("删除成功")}).catch(o=>{console.error("删除失败：",o),I.error("删除失败")})}).catch(()=>{})}}},xe=e=>(T("data-v-dfe21aa6"),e=e(),M(),e),Nl=xe(()=>n("div",{class:"el-upload__tip"},"文件流转平台支持上传任意文件（建议不大于50MB），上传后的文件所有系统用户均可见。",-1)),jl=xe(()=>n("div",{class:"el-upload__tip"},null,-1)),Ol={class:"search-container"},Kl=xe(()=>n("br",null,null,-1));function ql(e,o,r,p,a,s){const c=d("el-button"),_=d("el-upload"),v=d("el-input"),w=d("el-table-column"),g=d("el-table"),y=d("el-pagination");return i(),f("div",null,[t(_,{class:"upload-demo",action:a.uploadUrl,headers:{Authorization:e.token},"on-change":s.handleChange,"before-upload":e.beforeUpload,ref:"upload"},{default:l(()=>[t(c,{size:"medium",type:"primary",onClick:s.submitUpload,class:"upload-button"},{default:l(()=>[m(" 上传文件 ")]),_:1},8,["onClick"])]),_:1},8,["action","headers","on-change","before-upload"]),Nl,jl,n("div",Ol,[t(v,{modelValue:a.fileName,"onUpdate:modelValue":o[0]||(o[0]=x=>a.fileName=x),onKeyup:B(s.search,["enter"]),placeholder:"文件名",class:"search-input",style:{width:"200px"}},null,8,["modelValue","onKeyup"]),t(c,{type:"primary",onClick:s.search,style:{"margin-left":"10px"}},{default:l(()=>[m("搜索")]),_:1},8,["onClick"])]),Kl,t(g,{data:a.fileList,style:{width:"100%"}},{default:l(()=>[t(w,{prop:"fileId",label:"文件ID"}),t(w,{prop:"fileName",label:"文件名"}),t(w,{prop:"targetUser",label:"上传用户（ID）"}),t(w,{prop:"createTime",label:"上传时间"}),t(w,{label:"操作"},{default:l(({row:x})=>[t(c,{type:"primary",size:"mini",plain:"",onClick:h=>s.handleDownload(x.fileId)},{default:l(()=>[m("下载")]),_:2},1032,["onClick"]),t(c,{type:"danger",size:"mini",plain:"",onClick:h=>s.handleDelete(x.fileId)},{default:l(()=>[m("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a.total>a.pageSize?(i(),b(y,{key:0,onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange,"page-sizes":[10,30,50,100],"page-size":a.pageSize,total:a.total,layout:"sizes, prev, pager, next, jumper"},null,8,["onSizeChange","onCurrentChange","page-size","total"])):S("",!0)])}const Yl=V(Ll,[["render",ql],["__scopeId","data-v-dfe21aa6"]]),Gl=e=>D.get("/rec2",{params:e}),Zl=async e=>{try{return(await D.get("/rec2/search",{params:e})).data}catch(o){throw console.error("请求表格数据失败:",o),o}},Xl=async e=>{try{return(await D.get("/score2/search",{params:{stuId:e}})).data}catch(o){throw console.error("请求分数数据失败:",o),o}},Wl={components:{ElTable:W,ElTableColumn:J,ElInput:_e,ElButton:Q,ElTag:me},data(){return{tableData:[],tableData2:[],tableColumns:[{label:"ID",prop:"opr_id"},{label:"学号",prop:"opr_target_stu"},{label:"姓名",prop:"stu_name"},{label:"操作分数",prop:"opr_score"},{label:"原因",prop:"opr_reason"},{label:"时间",prop:"oprTime"},{label:"状态",prop:"status"}],tableColumns2:[{label:"ID",prop:"opr_id"},{label:"学号",prop:"opr_target_stu"},{label:"姓名",prop:"stu_name"},{label:"操作分数",prop:"opr_score"},{label:"原因",prop:"opr_reason"},{label:"时间",prop:"oprTime"},{label:"状态",prop:"status"}],stu_id:"",id_end:"",score:0,score2:0,searchDisabled:!1,countdown:10}},computed:{searchButtonText(){return this.searchDisabled?`搜索 (${this.countdown})`:"搜索"}},methods:{getStatusTagType(e){switch(e){case 1:return"success";case 2:return"primary";case 0:return"danger";case 8:return"info";default:return"black"}},getStatusText(e){switch(e){case 1:return"有效";case 0:return"已撤销";case 2:return"系统锁定";case 8:return"审核中";default:return e}},async handleSearch(){try{if(this.searchDisabled)return;this.searchDisabled=!0,I({message:"正在查询，搜索按钮10秒内不可重复点击",type:"warning"});const e={stuId:this.stu_id,idEnd6:this.id_end},o=await pl(e);this.tableData=o;const r=await Zl(e);this.tableData2=r;const p=await hl(this.stu_id);this.score=p;const a=await Xl(this.stu_id);this.score2=a,this.startCountdown()}catch(e){console.error("请求数据失败:",e),this.searchDisabled=!1}},startCountdown(){const e=setInterval(()=>{this.countdown>0?this.countdown--:(clearInterval(e),this.searchDisabled=!1,this.countdown=10)},1e3)}}},Z=e=>(T("data-v-caf31785"),e=e(),M(),e),Jl=Z(()=>n("p",{class:"fp"},"学生端——分数查询",-1)),Ql={class:"search-container"},ea=Z(()=>n("p",{style:{color:"gray"}},"如果无法查询或对查询结果有疑义，请联系学生会综合部",-1)),ta=Z(()=>n("p",{class:"fp2"},"德育分",-1)),oa={class:"score-display"},la={key:0},aa={key:2},sa=Z(()=>n("p",{class:"fp2"},"第二课堂积分",-1)),na=Z(()=>n("p",{style:{color:"gray"}},"2022级及更高年级不涉及第二课堂学分，无需关注",-1)),ra={class:"score-display"},ia={key:0},ca={key:2},da=Z(()=>n("br",null,null,-1));function ua(e,o,r,p,a,s){const c=d("el-input"),_=d("el-button"),v=d("el-tag"),w=d("el-table-column"),g=d("el-table"),y=d("el-card"),x=d("center"),h=d("el-footer");return i(),f(E,null,[t(y,{class:"page-container"},{default:l(()=>[n("div",null,[Jl,n("div",Ql,[t(c,{modelValue:a.stu_id,"onUpdate:modelValue":o[0]||(o[0]=u=>a.stu_id=u),onKeyup:B(s.handleSearch,["enter"]),placeholder:"学号",class:"search-input"},null,8,["modelValue","onKeyup"]),t(c,{modelValue:a.id_end,"onUpdate:modelValue":o[1]||(o[1]=u=>a.id_end=u),onKeyup:B(s.handleSearch,["enter"]),placeholder:"身份证号后六位",class:"search-input"},null,8,["modelValue","onKeyup"]),t(_,{type:"primary",disabled:a.searchDisabled,onClick:s.handleSearch},{default:l(()=>[m($(s.searchButtonText),1)]),_:1},8,["disabled","onClick"])]),ea,ta,n("div",oa,[n("p",null,"分数: "+$(a.score),1)]),t(g,{data:a.tableData,border:"",stripe:"",style:{width:"100%","white-space":"nowrap"},height:e.tableHeight,"show-overflow-tooltip":"","cell-style":{textAlign:"center"},"header-cell-style":{textAlign:"center"},fit:!0},{default:l(()=>[(i(!0),f(E,null,H(a.tableColumns,u=>(i(),b(w,{key:u.prop,prop:u.prop,label:u.label},{default:l(({row:k})=>[u.prop==="status"?(i(),f("div",la,[t(v,{type:s.getStatusTagType(k[u.prop]),class:"status-tag"},{default:l(()=>[m($(s.getStatusText(k[u.prop])),1)]),_:2},1032,["type"])])):u.prop==="opr_score"?(i(),f("span",{key:1,style:X({"font-weight":"bold",color:k[u.prop]>=0?"green":"red"})},$(k[u.prop]),5)):(i(),f("span",aa,$(k[u.prop]),1))]),_:2},1032,["prop","label"]))),128))]),_:1},8,["data","height"])]),n("div",null,[sa,na,n("div",ra,[n("p",null,"分数: "+$(a.score2),1)]),t(g,{data:a.tableData2,border:"",stripe:"",style:{width:"100%","white-space":"nowrap"},height:e.tableHeight,"show-overflow-tooltip":"","cell-style":{textAlign:"center"},"header-cell-style":{textAlign:"center"},fit:!0},{default:l(()=>[(i(!0),f(E,null,H(a.tableColumns2,u=>(i(),b(w,{key:u.prop,prop:u.prop,label:u.label},{default:l(({row:k})=>[u.prop==="status"?(i(),f("div",ia,[t(v,{type:s.getStatusTagType(k[u.prop]),class:"status-tag"},{default:l(()=>[m($(s.getStatusText(k[u.prop])),1)]),_:2},1032,["type"])])):u.prop==="opr_score"?(i(),f("span",{key:1,style:X({"font-weight":"bold",color:k[u.prop]>=0?"green":"red"})},$(k[u.prop]),5)):(i(),f("span",ca,$(k[u.prop]),1))]),_:2},1032,["prop","label"]))),128))]),_:1},8,["data","height"])])]),_:1}),t(h,null,{default:l(()=>[t(x,null,{default:l(()=>[m("stuTrack Developed by 张丰伟"),da,m("Version: v0.13.0-alpha")]),_:1})]),_:1})],64)}const pa=V(Wl,[["render",ua],["__scopeId","data-v-caf31785"]]),ha={data(){return{userData:[],registerDrawerVisible:!1,registerForm:{username:"",name:"",password:"",roleId:""}}},mounted(){this.fetchUserData()},methods:{fetchUserData(){D.get("/users/getAll").then(e=>{this.userData=e.data}).catch(e=>{console.error("获取用户数据时出错:",e)})},editRow(e){e.editing=!0,e.editName=e.name,e.editRoleId=e.roleId},submitEdit(e){delete e.editing,e.name=e.editName,e.roleId=e.editRoleId,delete e.editName,delete e.editRoleId,D.post("/users/info",e).then(o=>{console.log("数据已成功更新:",o.data),I.success("数据更新成功"),this.fetchUserData}).catch(o=>{console.error("更新用户数据时出错:",o)})},showRegisterDrawer(){this.registerDrawerVisible=!0},registerUser(){D.post("/users/register",this.registerForm).then(e=>{console.log("用户注册成功:",e.data),I.success("用户注册成功"),this.registerDrawerVisible=!1,this.fetchUserData(),this.registerForm.username="",this.registerForm.name="",this.registerForm.password="",this.registerForm.roleId=""}).catch(e=>{console.error("用户注册失败:",e),I.error("用户注册失败")})},updateIsDeleted(e){D.post("/users/info",e).then(o=>{I.success("账户状态已变更")}).catch(o=>{console.error("更新账户状态时出错:",o),I.error("账户状态更新失败"),e.isDeleted=!e.isDeleted})}}},A=e=>(T("data-v-7ed128ff"),e=e(),M(),e),_a=A(()=>n("span",{class:"description"},"用户名说明：8-64位字符，限英文和数字",-1)),ma=A(()=>n("br",null,null,-1)),fa=A(()=>n("br",null,null,-1)),ga=A(()=>n("span",{class:"description"},"密码说明：8-64位字符，限英文和数字",-1)),ba=A(()=>n("br",null,null,-1)),va=A(()=>n("br",null,null,-1)),ya=A(()=>n("span",{class:"description"},"角色ID说明：学生工作办公室-4 超级管理员-8 学生会综合部-11 团委-12 公寓管理服务中心-13 学生会学习部-14 团学组织通用-15",-1)),Da=A(()=>n("br",null,null,-1)),wa=A(()=>n("br",null,null,-1)),xa=A(()=>n("br",null,null,-1)),za={slot:"footer",class:"dialog-footer"},Fa={key:0},Ca={key:0};function ka(e,o,r,p,a,s){const c=d("el-button"),_=d("el-input"),v=d("el-form-item"),w=d("el-form"),g=d("el-drawer"),y=d("el-table-column"),x=d("el-switch"),h=d("el-table");return i(),f("div",null,[t(c,{type:"primary",class:"register-button",onClick:s.showRegisterDrawer},{default:l(()=>[m("注册用户")]),_:1},8,["onClick"]),t(g,{title:"注册用户",modelValue:a.registerDrawerVisible,"onUpdate:modelValue":o[5]||(o[5]=u=>a.registerDrawerVisible=u),width:"30%","with-header":!1,"append-to-body":!0,"close-on-click-modal":!0,"close-on-press-escape":!1,onClose:o[6]||(o[6]=u=>a.registerDrawerVisible=!1)},{default:l(()=>[t(w,{model:a.registerForm,"label-width":"80px"},{default:l(()=>[t(v,{label:"用户名",prop:"username"},{default:l(()=>[t(_,{modelValue:a.registerForm.username,"onUpdate:modelValue":o[0]||(o[0]=u=>a.registerForm.username=u),placeholder:"请输入用户名（8-64位字符）"},null,8,["modelValue"])]),_:1}),t(v,{label:"名字",prop:"name"},{default:l(()=>[t(_,{modelValue:a.registerForm.name,"onUpdate:modelValue":o[1]||(o[1]=u=>a.registerForm.name=u),placeholder:"请输入名字"},null,8,["modelValue"])]),_:1}),t(v,{label:"密码",prop:"password"},{default:l(()=>[t(_,{modelValue:a.registerForm.password,"onUpdate:modelValue":o[2]||(o[2]=u=>a.registerForm.password=u),type:"password",placeholder:"请输入密码（8-64位字符）"},null,8,["modelValue"])]),_:1}),t(v,{label:"角色ID",prop:"roleId"},{default:l(()=>[t(_,{modelValue:a.registerForm.roleId,"onUpdate:modelValue":o[3]||(o[3]=u=>a.registerForm.roleId=u),placeholder:"请输入角色ID"},null,8,["modelValue"])]),_:1}),_a,ma,fa,ga,ba,va,ya,Da,wa,xa]),_:1},8,["model"]),n("div",za,[t(c,{onClick:o[4]||(o[4]=u=>a.registerDrawerVisible=!1)},{default:l(()=>[m("取消")]),_:1}),t(c,{type:"primary",onClick:s.registerUser},{default:l(()=>[m("注册")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"]),t(h,{data:a.userData,style:{width:"100%"}},{default:l(()=>[t(y,{prop:"uid",label:"用户ID"}),t(y,{prop:"username",label:"系统用户名"}),t(y,{prop:"name",label:"用户称呼"},{default:l(({row:u})=>[u.editing?(i(),b(_,{key:1,modelValue:u.editName,"onUpdate:modelValue":k=>u.editName=k},null,8,["modelValue","onUpdate:modelValue"])):(i(),f("span",Fa,$(u.name||"未知"),1))]),_:1}),t(y,{prop:"roleId",label:"角色ID"},{default:l(({row:u})=>[u.editing?(i(),b(_,{key:1,modelValue:u.editRoleId,"onUpdate:modelValue":k=>u.editRoleId=k},null,8,["modelValue","onUpdate:modelValue"])):(i(),f("span",Ca,$(u.roleId||"未知"),1))]),_:1}),t(y,{prop:"isDeleted",label:"启用状态"},{default:l(({row:u})=>[t(x,{modelValue:u.isDeleted,"onUpdate:modelValue":k=>u.isDeleted=k,"active-value":0,"inactive-value":1,disabled:u.uid===1,onChange:k=>s.updateIsDeleted(u)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:1}),t(y,{label:"操作"},{default:l(({row:u})=>[u.editing?(i(),b(c,{key:1,type:"success",plain:"",round:"",onClick:k=>s.submitEdit(u)},{default:l(()=>[m("提交")]),_:2},1032,["onClick"])):(i(),b(c,{key:0,onClick:k=>s.editRow(u),type:"primary",round:"",plain:"",disabled:u.uid===1},{default:l(()=>[m("修改")]),_:2},1032,["onClick","disabled"]))]),_:1})]),_:1},8,["data"])])}const Sa=V(ha,[["render",ka],["__scopeId","data-v-7ed128ff"]]),Va={name:"DevelopmentPage"},N=e=>(T("data-v-d1022dc8"),e=e(),M(),e),$a={class:"development-page"},Ia={class:"icon",style:{width:"6em",height:"6em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7508"},Ta=N(()=>n("path",{d:"M120.888889 163.555556h782.222222v412.444444H120.888889z",fill:"#5CBAEA","p-id":"5575"},null,-1)),Ma=N(()=>n("path",{d:"M874.666667 746.666667H149.333333c-31.288889 0-56.888889-25.6-56.888889-56.888889V604.444444h839.111112v85.333334c0 31.288889-25.6 56.888889-56.888889 56.888889zM611.555556 750.222222l71.111111 163.555556H341.333333l71.111111-163.555556z",fill:"#FFFFFF","p-id":"5576"},null,-1)),Ra=N(()=>n("path",{d:"M504.888889 675.555556m-28.444445 0a28.444444 28.444444 0 1 0 56.888889 0 28.444444 28.444444 0 1 0-56.888889 0Z",fill:"#194F82","p-id":"5577"},null,-1)),Ua=N(()=>n("path",{d:"M903.111111 106.666667H120.888889c-31.288889 0-56.888889 25.6-56.888889 56.888889v554.666666c0 31.288889 25.6 56.888889 56.888889 56.888889h245.333333l-42.666666 85.333333H263.111111c-15.644444 0-28.444444 12.8-28.444444 28.444445s12.8 28.444444 28.444444 28.444444h497.066667c15.644444 0 28.444444-12.8 28.444444-28.444444s-12.8-28.444444-28.444444-28.444445h-60.444445l-42.666666-85.333333H903.111111c31.288889 0 56.888889-25.6 56.888889-56.888889V163.555556c0-31.288889-25.6-56.888889-56.888889-56.888889z m0 611.555555H120.888889V632.888889h782.222222v85.333333z m-266.666667 142.222222h-248.888888l42.666666-85.333333h164.266667l41.955555 85.333333zM120.888889 576V163.555556h782.222222v412.444444H120.888889z",fill:"#194F82","p-id":"5578"},null,-1)),Ba=N(()=>n("path",{d:"M931.555556 731.022222l-199.111112 169.955556-199.111111-169.955556V525.511111l199.111111-59.022222 199.111112 59.022222z",fill:"#FFC10D","p-id":"5579"},null,-1)),Ea=N(()=>n("path",{d:"M732.444444 910.222222c-19.911111 0-40.533333-7.111111-56.177777-20.622222l-142.222223-120.888889c-18.488889-15.644444-29.155556-38.4-29.155555-61.866667V565.333333c0-36.266667 24.177778-68.266667 60.444444-78.933333l142.222223-41.955556c16.355556-4.977778 33.422222-4.977778 49.777777 0l142.222223 41.955556c36.266667 10.666667 60.444444 41.955556 60.444444 78.933333v141.511111c0 23.466667-10.666667 46.222222-29.155556 61.866667l-142.222222 120.888889c-15.644444 13.511111-36.266667 20.622222-56.177778 20.622222z m0-413.155555c-2.844444 0-5.688889 0.711111-8.533333 1.422222l-142.222222 41.955555c-12.088889 3.555556-19.911111 13.511111-19.911111 24.888889v141.511111c0 7.111111 3.555556 14.222222 9.244444 19.2l142.222222 120.888889c10.666667 9.244444 27.733333 9.244444 38.4 0l142.222223-120.888889c5.688889-4.977778 9.244444-12.088889 9.244444-19.2V565.333333c0-11.377778-7.822222-21.333333-19.911111-24.888889l-142.222222-41.955555c-2.844444-1.422222-5.688889-1.422222-8.533334-1.422222z",fill:"#194F82","p-id":"5580"},null,-1)),Ha=N(()=>n("path",{d:"M789.333333 694.044444h-28.444444v-14.222222c0-1.422222 0-2.133333-0.711111-3.555555 25.6-12.088889 43.377778-36.977778 43.377778-66.844445 0-40.533333-33.422222-73.244444-74.666667-73.244444S654.222222 568.888889 654.222222 609.422222c0 32 20.622222 59.022222 49.777778 68.977778v113.066667c0 15.644444 12.8 27.733333 28.444444 27.733333s28.444444-12.8 28.444445-27.733333v-41.955556h28.444444c15.644444 0 28.444444-12.8 28.444445-27.733333 0-14.933333-12.8-27.733333-28.444445-27.733334z m-60.444444-101.688888c9.955556 0 17.777778 7.822222 17.777778 17.777777s-7.822222 17.777778-17.777778 17.777778-17.777778-7.822222-17.777778-17.777778 7.822222-17.777778 17.777778-17.777777z",fill:"#194F82","p-id":"5581"},null,-1)),Aa=[Ta,Ma,Ra,Ua,Ba,Ea,Ha],Pa=N(()=>n("p",{class:"message"},"当前账号没有访问权限",-1));function La(e,o,r,p,a,s){return i(),f("div",$a,[(i(),f("svg",Ia,Aa)),Pa])}const Na=V(Va,[["render",La],["__scopeId","data-v-d1022dc8"]]),ja={name:"DevelopmentPage"},j=e=>(T("data-v-b2def47e"),e=e(),M(),e),Oa={class:"development-page"},Ka={class:"icon",style:{width:"6em",height:"6em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7508"},qa=j(()=>n("path",{d:"M120.888889 163.555556h782.222222v412.444444H120.888889z",fill:"#5CBAEA","p-id":"5575"},null,-1)),Ya=j(()=>n("path",{d:"M874.666667 746.666667H149.333333c-31.288889 0-56.888889-25.6-56.888889-56.888889V604.444444h839.111112v85.333334c0 31.288889-25.6 56.888889-56.888889 56.888889zM611.555556 750.222222l71.111111 163.555556H341.333333l71.111111-163.555556z",fill:"#FFFFFF","p-id":"5576"},null,-1)),Ga=j(()=>n("path",{d:"M504.888889 675.555556m-28.444445 0a28.444444 28.444444 0 1 0 56.888889 0 28.444444 28.444444 0 1 0-56.888889 0Z",fill:"#194F82","p-id":"5577"},null,-1)),Za=j(()=>n("path",{d:"M903.111111 106.666667H120.888889c-31.288889 0-56.888889 25.6-56.888889 56.888889v554.666666c0 31.288889 25.6 56.888889 56.888889 56.888889h245.333333l-42.666666 85.333333H263.111111c-15.644444 0-28.444444 12.8-28.444444 28.444445s12.8 28.444444 28.444444 28.444444h497.066667c15.644444 0 28.444444-12.8 28.444444-28.444444s-12.8-28.444444-28.444444-28.444445h-60.444445l-42.666666-85.333333H903.111111c31.288889 0 56.888889-25.6 56.888889-56.888889V163.555556c0-31.288889-25.6-56.888889-56.888889-56.888889z m0 611.555555H120.888889V632.888889h782.222222v85.333333z m-266.666667 142.222222h-248.888888l42.666666-85.333333h164.266667l41.955555 85.333333zM120.888889 576V163.555556h782.222222v412.444444H120.888889z",fill:"#194F82","p-id":"5578"},null,-1)),Xa=j(()=>n("path",{d:"M931.555556 731.022222l-199.111112 169.955556-199.111111-169.955556V525.511111l199.111111-59.022222 199.111112 59.022222z",fill:"#FFC10D","p-id":"5579"},null,-1)),Wa=j(()=>n("path",{d:"M732.444444 910.222222c-19.911111 0-40.533333-7.111111-56.177777-20.622222l-142.222223-120.888889c-18.488889-15.644444-29.155556-38.4-29.155555-61.866667V565.333333c0-36.266667 24.177778-68.266667 60.444444-78.933333l142.222223-41.955556c16.355556-4.977778 33.422222-4.977778 49.777777 0l142.222223 41.955556c36.266667 10.666667 60.444444 41.955556 60.444444 78.933333v141.511111c0 23.466667-10.666667 46.222222-29.155556 61.866667l-142.222222 120.888889c-15.644444 13.511111-36.266667 20.622222-56.177778 20.622222z m0-413.155555c-2.844444 0-5.688889 0.711111-8.533333 1.422222l-142.222222 41.955555c-12.088889 3.555556-19.911111 13.511111-19.911111 24.888889v141.511111c0 7.111111 3.555556 14.222222 9.244444 19.2l142.222222 120.888889c10.666667 9.244444 27.733333 9.244444 38.4 0l142.222223-120.888889c5.688889-4.977778 9.244444-12.088889 9.244444-19.2V565.333333c0-11.377778-7.822222-21.333333-19.911111-24.888889l-142.222222-41.955555c-2.844444-1.422222-5.688889-1.422222-8.533334-1.422222z",fill:"#194F82","p-id":"5580"},null,-1)),Ja=j(()=>n("path",{d:"M789.333333 694.044444h-28.444444v-14.222222c0-1.422222 0-2.133333-0.711111-3.555555 25.6-12.088889 43.377778-36.977778 43.377778-66.844445 0-40.533333-33.422222-73.244444-74.666667-73.244444S654.222222 568.888889 654.222222 609.422222c0 32 20.622222 59.022222 49.777778 68.977778v113.066667c0 15.644444 12.8 27.733333 28.444444 27.733333s28.444444-12.8 28.444445-27.733333v-41.955556h28.444444c15.644444 0 28.444444-12.8 28.444445-27.733333 0-14.933333-12.8-27.733333-28.444445-27.733334z m-60.444444-101.688888c9.955556 0 17.777778 7.822222 17.777778 17.777777s-7.822222 17.777778-17.777778 17.777778-17.777778-7.822222-17.777778-17.777778 7.822222-17.777778 17.777778-17.777777z",fill:"#194F82","p-id":"5581"},null,-1)),Qa=[qa,Ya,Ga,Za,Xa,Wa,Ja],es=j(()=>n("p",{class:"message"},"当前账号没有访问权限",-1));function ts(e,o,r,p,a,s){return i(),f("div",Oa,[(i(),f("svg",Ka,Qa)),es])}const os=V(ja,[["render",ts],["__scopeId","data-v-b2def47e"]]),ls={name:"DevelopmentPage"},O=e=>(T("data-v-d7f9fffe"),e=e(),M(),e),as={class:"development-page"},ss={class:"icon",style:{width:"6em",height:"6em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7508"},ns=O(()=>n("path",{d:"M120.888889 163.555556h782.222222v412.444444H120.888889z",fill:"#5CBAEA","p-id":"5575"},null,-1)),rs=O(()=>n("path",{d:"M874.666667 746.666667H149.333333c-31.288889 0-56.888889-25.6-56.888889-56.888889V604.444444h839.111112v85.333334c0 31.288889-25.6 56.888889-56.888889 56.888889zM611.555556 750.222222l71.111111 163.555556H341.333333l71.111111-163.555556z",fill:"#FFFFFF","p-id":"5576"},null,-1)),is=O(()=>n("path",{d:"M504.888889 675.555556m-28.444445 0a28.444444 28.444444 0 1 0 56.888889 0 28.444444 28.444444 0 1 0-56.888889 0Z",fill:"#194F82","p-id":"5577"},null,-1)),cs=O(()=>n("path",{d:"M903.111111 106.666667H120.888889c-31.288889 0-56.888889 25.6-56.888889 56.888889v554.666666c0 31.288889 25.6 56.888889 56.888889 56.888889h245.333333l-42.666666 85.333333H263.111111c-15.644444 0-28.444444 12.8-28.444444 28.444445s12.8 28.444444 28.444444 28.444444h497.066667c15.644444 0 28.444444-12.8 28.444444-28.444444s-12.8-28.444444-28.444444-28.444445h-60.444445l-42.666666-85.333333H903.111111c31.288889 0 56.888889-25.6 56.888889-56.888889V163.555556c0-31.288889-25.6-56.888889-56.888889-56.888889z m0 611.555555H120.888889V632.888889h782.222222v85.333333z m-266.666667 142.222222h-248.888888l42.666666-85.333333h164.266667l41.955555 85.333333zM120.888889 576V163.555556h782.222222v412.444444H120.888889z",fill:"#194F82","p-id":"5578"},null,-1)),ds=O(()=>n("path",{d:"M931.555556 731.022222l-199.111112 169.955556-199.111111-169.955556V525.511111l199.111111-59.022222 199.111112 59.022222z",fill:"#FFC10D","p-id":"5579"},null,-1)),us=O(()=>n("path",{d:"M732.444444 910.222222c-19.911111 0-40.533333-7.111111-56.177777-20.622222l-142.222223-120.888889c-18.488889-15.644444-29.155556-38.4-29.155555-61.866667V565.333333c0-36.266667 24.177778-68.266667 60.444444-78.933333l142.222223-41.955556c16.355556-4.977778 33.422222-4.977778 49.777777 0l142.222223 41.955556c36.266667 10.666667 60.444444 41.955556 60.444444 78.933333v141.511111c0 23.466667-10.666667 46.222222-29.155556 61.866667l-142.222222 120.888889c-15.644444 13.511111-36.266667 20.622222-56.177778 20.622222z m0-413.155555c-2.844444 0-5.688889 0.711111-8.533333 1.422222l-142.222222 41.955555c-12.088889 3.555556-19.911111 13.511111-19.911111 24.888889v141.511111c0 7.111111 3.555556 14.222222 9.244444 19.2l142.222222 120.888889c10.666667 9.244444 27.733333 9.244444 38.4 0l142.222223-120.888889c5.688889-4.977778 9.244444-12.088889 9.244444-19.2V565.333333c0-11.377778-7.822222-21.333333-19.911111-24.888889l-142.222222-41.955555c-2.844444-1.422222-5.688889-1.422222-8.533334-1.422222z",fill:"#194F82","p-id":"5580"},null,-1)),ps=O(()=>n("path",{d:"M789.333333 694.044444h-28.444444v-14.222222c0-1.422222 0-2.133333-0.711111-3.555555 25.6-12.088889 43.377778-36.977778 43.377778-66.844445 0-40.533333-33.422222-73.244444-74.666667-73.244444S654.222222 568.888889 654.222222 609.422222c0 32 20.622222 59.022222 49.777778 68.977778v113.066667c0 15.644444 12.8 27.733333 28.444444 27.733333s28.444444-12.8 28.444445-27.733333v-41.955556h28.444444c15.644444 0 28.444444-12.8 28.444445-27.733333 0-14.933333-12.8-27.733333-28.444445-27.733334z m-60.444444-101.688888c9.955556 0 17.777778 7.822222 17.777778 17.777777s-7.822222 17.777778-17.777778 17.777778-17.777778-7.822222-17.777778-17.777778 7.822222-17.777778 17.777778-17.777777z",fill:"#194F82","p-id":"5581"},null,-1)),hs=[ns,rs,is,cs,ds,us,ps],_s=O(()=>n("p",{class:"message"},"当前账号没有访问权限",-1));function ms(e,o,r,p,a,s){return i(),f("div",as,[(i(),f("svg",ss,hs)),_s])}const fs=V(ls,[["render",ms],["__scopeId","data-v-d7f9fffe"]]),gs={data(){return{selectedFile:null,uploadUrl:"/rec2/upload",activeStep:0}},methods:{submitUpload(){this.$nextTick(()=>{this.$refs.upload.submit()})},handleChange(e,o){if(e.status==="success"){const r=this.selectedFile||e.raw;console.log("userSelectedFile:",r);const p=new FormData;p.append("file",r),D.post(this.uploadUrl,p).then(a=>{this.handleRequestSuccess(a),this.activeStep=1}).catch(a=>this.handleRequestError(a))}},handleRequestSuccess(e){console.log("请求成功：",e)},handleRequestError(e){console.error("请求失败：",e)},beforeUpload(e){const o=e.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";return o?(this.selectedFile=e.raw,console.log("this.selectedFile:",this.selectedFile)):this.$message.error("只能上传xlsx文件"),o},importTable(){D.get("/rec/upload").then(e=>{this.handleRefreshSuccess(e),this.activeStep=2}).catch(e=>this.handleRefreshError(e))},refreshTable(){D.get("/rec/refresh").then(e=>{this.handleRefreshSuccess(e),this.activeStep=3}).catch(e=>this.handleRefreshError(e))},handleRefreshSuccess(e){e.code===200?this.$message.success("第二课堂积分表已载入完毕！"):this.$message.error("载入失败："+e.message)},async downloadModel(){try{({code:200}).code===200&&(this.$message.success("请稍后..."),setTimeout(()=>{this.$message.success("即将开始下载..."),te(2)},2e3))}catch(e){console.error("Error exporting roster:",e)}},handleRefreshError(e){console.error("刷新失败：",e)},confirmImport(){R.confirm("刷新后分数将变为“审核中”状态！","确认刷新",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.importTable()}).catch(()=>{})},confirmRefresh(){R.confirm("刷新后，分数操作将生效。如需撤销请前往记录查询页面","确认刷新",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.refreshTable()}).catch(()=>{})}}},bs=e=>(T("data-v-d53c48a0"),e=e(),M(),e),vs=bs(()=>n("div",{class:"el-upload__tip"},"只能上传*.xlsx文件",-1));function ys(e,o,r,p,a,s){const c=d("el-step"),_=d("el-steps"),v=d("el-button"),w=d("el-upload");return i(),f("div",null,[t(_,{class:"steps-container",active:a.activeStep,"align-center":"","finish-status":"success",simple:""},{default:l(()=>[t(c,{title:"上传",icon:e.UploadFilled},null,8,["icon"]),t(c,{title:"导入",icon:e.Tools},null,8,["icon"]),t(c,{title:"通过审核",icon:e.Check},null,8,["icon"])]),_:1},8,["active"]),t(w,{class:"upload-demo",action:a.uploadUrl,headers:{Authorization:e.token},"on-change":s.handleChange,"before-upload":s.beforeUpload,ref:"upload"},{default:l(()=>[t(v,{size:"medium",type:"primary",onClick:s.submitUpload,class:"upload-button"},{default:l(()=>[m(" 上传文件 ")]),_:1},8,["onClick"])]),_:1},8,["action","headers","on-change","before-upload"]),vs,t(v,{size:"medium",type:"info",plain:"",onClick:s.downloadModel,class:"refresh-button"},{default:l(()=>[m(" 下载模板 ")]),_:1},8,["onClick"]),t(v,{size:"medium",type:"primary",plain:"",onClick:s.confirmImport,class:"refresh-button"},{default:l(()=>[m(" 导入数据 ")]),_:1},8,["onClick"]),t(v,{size:"medium",type:"success",plain:"",onClick:s.confirmRefresh,class:"refresh-button"},{default:l(()=>[m(" 通过审核 ")]),_:1},8,["onClick"])])}const Ds=V(gs,[["render",ys],["__scopeId","data-v-d53c48a0"]]),ws={components:{ElTable:W,ElTableColumn:J,ElPagination:he,ElInput:_e,ElButton:Q,ElTag:me},data(){return{tableData:[],tableColumns:[{label:"ID",prop:"opr_id"},{label:"学号",prop:"opr_target_stu"},{label:"姓名",prop:"stu_name"},{label:"操作分数",prop:"opr_score"},{label:"操作后分数",prop:"target_stu_score"},{label:"原因",prop:"opr_reason"},{label:"时间",prop:"oprTime"},{label:"状态",prop:"status"}],pageSize:30,total:100,currentPage:1,stu_id:"",opr_time:""}},methods:{getStatusTagType(e){switch(e){case 1:return"success";case 2:return"primary";case 0:return"danger";case 8:return"info";default:return"black"}},getStatusText(e){switch(e){case 1:return"有效";case 0:return"已撤销";case 2:return"系统锁定";case 8:return"审核中";default:return e}},async fetchData(){const e={pageNum:this.currentPage,pageSize:this.pageSize,stu_id:this.stu_id,opr_time:this.opr_time},r=(await Gl(e)).data;console.log("接口返回的数据:",r),this.tableData=r.current_item,this.total=r.total},handleSizeChange(e){this.pageSize=e,this.fetchData()},handleCurrentChange(e){this.currentPage=e,this.fetchData()},search(){this.currentPage=1,this.fetchData()},async handleUndo(e){if(e.status!==1){R.alert("当前记录无法撤销","提示",{confirmButtonText:"确定",type:"warning"});return}try{if(await R.confirm("确定要执行撤销操作吗？（撤销操作不可逆，同时会生成一条锁定的撤销操作数据）","确认撤销",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})){const r=await D.post("/rec2/undo",{opr_id:e.opr_id});R.alert("撤销成功","提示",{confirmButtonText:"确定",type:"success"}),this.fetchData()}}catch{R.alert("已取消撤销操作","提示",{confirmButtonText:"确定",type:"error"})}}},mounted(){this.fetchData()}},xs={class:"search-container"},zs={key:0},Fs={key:2};function Cs(e,o,r,p,a,s){const c=d("el-input"),_=d("el-button"),v=d("el-tag"),w=d("el-table-column"),g=d("el-table"),y=d("el-pagination"),x=d("el-card");return i(),b(x,{class:"page-container"},{default:l(()=>[n("div",null,[n("div",xs,[t(c,{modelValue:a.stu_id,"onUpdate:modelValue":o[0]||(o[0]=h=>a.stu_id=h),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"学号",class:"search-input"},null,8,["modelValue","onKeyup","onBlur"]),t(c,{modelValue:a.opr_time,"onUpdate:modelValue":o[1]||(o[1]=h=>a.opr_time=h),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"操作时间(YYYY-MM-DD)",class:"search-input"},null,8,["modelValue","onKeyup","onBlur"]),t(_,{type:"primary",onClick:s.search},{default:l(()=>[m("搜索")]),_:1},8,["onClick"])]),t(g,{data:a.tableData,border:"",stripe:"",style:{width:"100%","white-space":"nowrap"},height:e.tableHeight,"show-overflow-tooltip":"","cell-style":{textAlign:"center"},"header-cell-style":{textAlign:"center"},fit:!0},{default:l(()=>[(i(!0),f(E,null,H(a.tableColumns,h=>(i(),b(w,{key:h.prop,prop:h.prop,label:h.label},{default:l(({row:u})=>[h.prop==="status"?(i(),f("div",zs,[t(v,{type:s.getStatusTagType(u[h.prop]),class:"status-tag"},{default:l(()=>[m($(s.getStatusText(u[h.prop])),1)]),_:2},1032,["type"])])):h.prop==="opr_score"?(i(),f("span",{key:1,style:X({"font-weight":"bold",color:u[h.prop]>=0?"green":"red"})},$(u[h.prop]),5)):(i(),f("span",Fs,$(u[h.prop]),1))]),_:2},1032,["prop","label"]))),128)),t(w,{label:"操作"},{default:l(({row:h})=>[t(_,{type:"danger",onClick:u=>s.handleUndo(h),plain:"",class:"undo-button"},{default:l(()=>[m("撤销")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","height"]),a.total>a.pageSize?(i(),b(y,{key:0,onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange,"page-sizes":[10,30,50,100],"page-size":a.pageSize,total:a.total,layout:"sizes, prev, pager, next, jumper"},null,8,["onSizeChange","onCurrentChange","page-size","total"])):S("",!0)])]),_:1})}const ks=V(ws,[["render",Cs],["__scopeId","data-v-f68cc17f"]]),Ss={data(){return{}},methods:{async exportRoster(){try{({code:200}).code===200&&(I.success("正在导出，请稍后..."),setTimeout(()=>{I.success("导出成功，即将开始下载..."),te(4)},2e3))}catch(e){console.error("Error exporting roster:",e)}}}},ie=e=>(T("data-v-aa5adaa4"),e=e(),M(),e),Vs={class:"export-roster-container"},$s={class:"development-page"},Is={class:"icon",style:{width:"8em",height:"8em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5721"},Ts=ie(()=>n("path",{d:"M96 96h640l192 192v640H96z",fill:"#FFFFFF","p-id":"5722"},null,-1)),Ms=ie(()=>n("path",{d:"M384 544v32H256v320h128v32H96V96h640l192 192v160h-32V301.248l-160-160V384H288V128H128v768h96V544h160zM320 128v224h384V128H320z",fill:"#5D6D7E","p-id":"5723"},null,-1)),Rs=ie(()=>n("path",{d:"M320 640h64v32h-64v-32z m0 96h64v32h-64v-32z",fill:"#ACB4C0","p-id":"5724"},null,-1)),Us=ie(()=>n("path",{d:"M544 160h96v160h-96z",fill:"#3B97D3","p-id":"5725"},null,-1)),Bs=ie(()=>n("path",{d:"M736 928v32l-288-66.56V539.104L736 480v32h192a32 32 0 0 1 32 32v352a32 32 0 0 1-32 32h-192z m0-32h192V544h-192v352z m-224-95.68h38.816l35.68-55.424 38.72 59.968 39.872 0.48-58.816-87.456 54.624-83.2-39.68 0.736-34.08 56.096L554.976 640h-37.824l49.632 76.672L512 800.352zM736 576h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m96-256h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z m0 64h64v32h-64v-32z",fill:"#1E7144","p-id":"5726"},null,-1)),Es=[Ts,Ms,Rs,Us,Bs];function Hs(e,o,r,p,a,s){const c=d("el-button");return i(),f("div",Vs,[n("div",$s,[(i(),f("svg",Is,Es))]),t(c,{class:"export-button",onClick:s.exportRoster},{default:l(()=>[m("导出第二课堂积分")]),_:1},8,["onClick"])])}const As=V(Ss,[["render",Hs],["__scopeId","data-v-aa5adaa4"]]),Ps={setup(){const e=K(Se()),o=K("");setInterval(()=>{e.value=Se(),r()},1e3);function r(){const p=new Date(2024,2,1),s=new Date-p,c=Math.floor(s/(1e3*60*60*24)),_=Math.floor(s%(1e3*60*60*24)/(1e3*60*60)),v=Math.floor(s%(1e3*60*60)/(1e3*60)),w=Math.floor(s%(1e3*60)/1e3);o.value=`${c} 天 ${_} 小时 ${v} 分钟 ${w} 秒`}return{currentTime:e,timeSinceMarch1:o}}};function Se(){return new Date().toLocaleString()}const ge=e=>(T("data-v-823fe2da"),e=e(),M(),e),Ls={style:{margin:"0",color:"green"}},Ns=ge(()=>n("p",{style:{color:"red","font-weight":"bold"}},[m(" 系统处于测试阶段，未正式上线！"),n("br"),m(" 测试期：2024年4月1日～2024年10月1日 ")],-1)),js=ge(()=>n("pre",{style:{"font-weight":"bold"}},`        _           _____                     _
   ___ | |_  _   _ /__   \\ _ __   __ _   ___ | | __
  / __|| __|| | | |  / /\\/| '__| / _\` | / __|| |/ /
  \\__ \\| |_ | |_| | / /   | |   | (_| || (__ |   <
  |___/ \\__| \\__,_| \\/    |_|    \\__,_| \\___||_|\\_\\
  
      `,-1)),Os=ge(()=>n("pre",null,`  🔨 Auth: 张丰伟
  
  📆 Version: v0.13.0-alpha
  
  📧 Feedback: zfw0920@163.com
  
      `,-1)),Ks=ge(()=>n("pre",{style:{color:"gray","line-height":"1.75"}},`  功能介绍：
  ◯统计视图 - 首页可查看各年级学生总数、男女人数及走读人数
  ◯一步 - 快速访问常用官网
  ◯学生管理 - 上传学生表、在线维护/查看学生名册、导出学生表
  ◯德育分中心 - 批量导入德育分数据、管理德育分操作记录、导出德育分表（超级管理员、学生工作办公室、学生会综合部）
  ◯第二课堂积分 - 批量导入分数数据、管理积分操作记录、导出第二课堂积分表（超级管理员、学生工作办公室、学生会综合部）
  ◯文件流转 - 一个用户上传文件、所有用户共享（超级管理员、学生工作办公室、学生会综合部）
  ◯用户管理 - 管理系统用户及权限（仅限超级管理员）
  
  注意事项：
  ◯受限于服务器硬件，首次加载较为缓慢，系统更新/服务器重启等运维操作同样可能导致此问题。
  ◯系统时间为格林尼治标准时间（GMT），慢于[北京时区8小时]。
  ◯学生名册等表格，将鼠标移到数据上可以查看全部信息，表格可左右滚动（触控板/触屏支持，PC请配合\`Shift\`键与鼠标滚轮使用）。
  ◯学生名册中“是否为特殊学生”慎用！重新上传表格后此项数据会丢失，暂无开发计划。
  ◯在线删除学生名册中的学生仅删除学生信息，数据库中该生之后的学生id不会前移，导出Excel后请留意序号是否连续。
  ◯上传学生表后，点击“刷新表格”以加载数据，建议等待30秒以上等待数据加载完毕。（硬件性能受限）
  ◯上传并加载学生表后德育分会复位到80分，第二课堂积分会复位到0分，请点击“修正分数”以恢复分数。
  ◯导出学生名册电脑端测试可用，手机端可能下载后文件后缀有误，自行更改为".xlsx"即可（Safari for iOS实测后缀有误）。
  ◯导出学生名册时，部分列为空白为正常现象（系统会根据当前用户权限导出对应信息）。
  ◯批量导入德育分/第二课堂积分时，请下载最新模板，模板中“姓名”等明显标注为[上传时请勿填写]的列请勿填写任何信息，否则将会导致程序运行错误！
  ◯批量导入德育分/第二课堂积分时，务必认真阅读Excel模板内的要求！否则可能造成数据错乱。
  ◯批量导入德育分/第二课堂积分时，上传文件后需依次点击“导入数据”和“通过审核”，操作时间视上传操作记录数量而定，每千条记录等待1分钟以上，否则可能造成数据缺漏（硬件性能受限）。
  ◯文件流转建议上传10MB内的小文件，不建议上传50MB以上的文件。（硬件性能受限）
      `,-1));function qs(e,o,r,p,a,s){return i(),f("div",null,[n("h3",Ls,"系统已稳定运行："+$(p.timeSinceMarch1),1),Ns,js,Os,Ks])}const Ys=V(Ps,[["render",qs],["__scopeId","data-v-823fe2da"]]),Gs={name:"DevelopmentPage"},L=e=>(T("data-v-f6502abb"),e=e(),M(),e),Zs={class:"development-page"},Xs={class:"icon",style:{width:"6em",height:"6em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7508"},Ws=L(()=>n("path",{d:"M120.888889 163.555556h782.222222v412.444444H120.888889z",fill:"#5CBAEA","p-id":"5575"},null,-1)),Js=L(()=>n("path",{d:"M874.666667 746.666667H149.333333c-31.288889 0-56.888889-25.6-56.888889-56.888889V604.444444h839.111112v85.333334c0 31.288889-25.6 56.888889-56.888889 56.888889zM611.555556 750.222222l71.111111 163.555556H341.333333l71.111111-163.555556z",fill:"#FFFFFF","p-id":"5576"},null,-1)),Qs=L(()=>n("path",{d:"M504.888889 675.555556m-28.444445 0a28.444444 28.444444 0 1 0 56.888889 0 28.444444 28.444444 0 1 0-56.888889 0Z",fill:"#194F82","p-id":"5577"},null,-1)),en=L(()=>n("path",{d:"M903.111111 106.666667H120.888889c-31.288889 0-56.888889 25.6-56.888889 56.888889v554.666666c0 31.288889 25.6 56.888889 56.888889 56.888889h245.333333l-42.666666 85.333333H263.111111c-15.644444 0-28.444444 12.8-28.444444 28.444445s12.8 28.444444 28.444444 28.444444h497.066667c15.644444 0 28.444444-12.8 28.444444-28.444444s-12.8-28.444444-28.444444-28.444445h-60.444445l-42.666666-85.333333H903.111111c31.288889 0 56.888889-25.6 56.888889-56.888889V163.555556c0-31.288889-25.6-56.888889-56.888889-56.888889z m0 611.555555H120.888889V632.888889h782.222222v85.333333z m-266.666667 142.222222h-248.888888l42.666666-85.333333h164.266667l41.955555 85.333333zM120.888889 576V163.555556h782.222222v412.444444H120.888889z",fill:"#194F82","p-id":"5578"},null,-1)),tn=L(()=>n("path",{d:"M931.555556 731.022222l-199.111112 169.955556-199.111111-169.955556V525.511111l199.111111-59.022222 199.111112 59.022222z",fill:"#FFC10D","p-id":"5579"},null,-1)),on=L(()=>n("path",{d:"M732.444444 910.222222c-19.911111 0-40.533333-7.111111-56.177777-20.622222l-142.222223-120.888889c-18.488889-15.644444-29.155556-38.4-29.155555-61.866667V565.333333c0-36.266667 24.177778-68.266667 60.444444-78.933333l142.222223-41.955556c16.355556-4.977778 33.422222-4.977778 49.777777 0l142.222223 41.955556c36.266667 10.666667 60.444444 41.955556 60.444444 78.933333v141.511111c0 23.466667-10.666667 46.222222-29.155556 61.866667l-142.222222 120.888889c-15.644444 13.511111-36.266667 20.622222-56.177778 20.622222z m0-413.155555c-2.844444 0-5.688889 0.711111-8.533333 1.422222l-142.222222 41.955555c-12.088889 3.555556-19.911111 13.511111-19.911111 24.888889v141.511111c0 7.111111 3.555556 14.222222 9.244444 19.2l142.222222 120.888889c10.666667 9.244444 27.733333 9.244444 38.4 0l142.222223-120.888889c5.688889-4.977778 9.244444-12.088889 9.244444-19.2V565.333333c0-11.377778-7.822222-21.333333-19.911111-24.888889l-142.222222-41.955555c-2.844444-1.422222-5.688889-1.422222-8.533334-1.422222z",fill:"#194F82","p-id":"5580"},null,-1)),ln=L(()=>n("path",{d:"M789.333333 694.044444h-28.444444v-14.222222c0-1.422222 0-2.133333-0.711111-3.555555 25.6-12.088889 43.377778-36.977778 43.377778-66.844445 0-40.533333-33.422222-73.244444-74.666667-73.244444S654.222222 568.888889 654.222222 609.422222c0 32 20.622222 59.022222 49.777778 68.977778v113.066667c0 15.644444 12.8 27.733333 28.444444 27.733333s28.444444-12.8 28.444445-27.733333v-41.955556h28.444444c15.644444 0 28.444444-12.8 28.444445-27.733333 0-14.933333-12.8-27.733333-28.444445-27.733334z m-60.444444-101.688888c9.955556 0 17.777778 7.822222 17.777778 17.777777s-7.822222 17.777778-17.777778 17.777778-17.777778-7.822222-17.777778-17.777778 7.822222-17.777778 17.777778-17.777777z",fill:"#194F82","p-id":"5581"},null,-1)),an=[Ws,Js,Qs,en,tn,on,ln],sn=L(()=>n("p",{class:"message"},"当前账号没有访问权限",-1)),nn=L(()=>n("p",{class:"message"},"如误报请联系学生会综合部",-1));function rn(e,o,r,p,a,s){return i(),f("div",Zs,[(i(),f("svg",Xs,an)),sn,nn])}const cn=V(Gs,[["render",rn],["__scopeId","data-v-f6502abb"]]),dn=e=>D.get("/discipline",{params:e}),un={components:{ElTable:W,ElTableColumn:J,ElPagination:he,ElInput:_e,ElButton:Q,ElTag:me},data(){return{tableData:[],tableColumns:[{label:"ID",prop:"id"},{label:"学号",prop:"stuId"},{label:"姓名",prop:"stuName"},{label:"类型",prop:"type"},{label:"描述",prop:"description"},{label:"操作人ID",prop:"userId"},{label:"操作时间",prop:"time"},{label:"状态",prop:"active"}],pageSize:30,total:100,currentPage:1,stuId:"",stuName:"",type:"",description:""}},methods:{getStatusTagType(e){switch(e){case"1":return"success";case"0":return"warning"}},getStatusText(e){switch(e){case"1":return"有效";case"0":return"已撤销";case"2":return"系统锁定";case"8":return"审核中";default:return e}},async fetchData(){const e={pageNum:this.currentPage,pageSize:this.pageSize,stuId:this.stuId,stuName:this.stuName,type:this.type,description:this.description},r=(await dn(e)).data;console.log("接口返回的数据:",r),this.tableData=r.current_item,this.total=r.total},handleSizeChange(e){this.pageSize=e,this.fetchData()},handleCurrentChange(e){this.currentPage=e,this.fetchData()},search(){this.currentPage=1,this.fetchData()},async handleUndo(e){if(e.active!=="1"){R.alert("当前记录无法撤销","提示",{confirmButtonText:"确定",type:"warning"});return}try{if(await R.confirm("确定要执行撤销操作吗？（撤销操作不可逆，同时会生成一条锁定的撤销操作数据）","确认撤销",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})){const r=await D.post("/discipline/undo",{id:e.id});R.alert("撤销成功","提示",{confirmButtonText:"确定",type:"success"}),this.fetchData()}}catch{R.alert("已取消撤销操作","提示",{confirmButtonText:"确定",type:"error"})}}},mounted(){this.fetchData()}},pn={class:"search-container"},hn={key:0},_n={key:1};function mn(e,o,r,p,a,s){const c=d("el-input"),_=d("el-button"),v=d("el-tag"),w=d("el-table-column"),g=d("el-table"),y=d("el-pagination"),x=d("el-card");return i(),b(x,{class:"page-container"},{default:l(()=>[n("div",null,[n("div",pn,[t(c,{modelValue:a.stuId,"onUpdate:modelValue":o[0]||(o[0]=h=>a.stuId=h),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"学号",class:"search-input"},null,8,["modelValue","onKeyup","onBlur"]),t(c,{modelValue:a.stuName,"onUpdate:modelValue":o[1]||(o[1]=h=>a.stuName=h),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"姓名",class:"search-input"},null,8,["modelValue","onKeyup","onBlur"]),t(c,{modelValue:a.type,"onUpdate:modelValue":o[2]||(o[2]=h=>a.type=h),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"类型",class:"search-input"},null,8,["modelValue","onKeyup","onBlur"]),t(c,{modelValue:a.description,"onUpdate:modelValue":o[3]||(o[3]=h=>a.description=h),onKeyup:B(s.search,["enter"]),onBlur:s.search,placeholder:"描述",class:"search-input"},null,8,["modelValue","onKeyup","onBlur"]),t(_,{type:"primary",onClick:s.search},{default:l(()=>[m("搜索")]),_:1},8,["onClick"])]),t(g,{data:a.tableData,border:"",stripe:"",style:{width:"100%","white-space":"nowrap"},height:e.tableHeight,"show-overflow-tooltip":"","cell-style":{textAlign:"center"},"header-cell-style":{textAlign:"center"},fit:!0},{default:l(()=>[(i(!0),f(E,null,H(a.tableColumns,h=>(i(),b(w,{key:h.prop,prop:h.prop,label:h.label},{default:l(({row:u})=>[h.prop==="active"?(i(),f("div",hn,[t(v,{type:s.getStatusTagType(u[h.prop]),class:"status-tag"},{default:l(()=>[m($(s.getStatusText(u[h.prop])),1)]),_:2},1032,["type"])])):(i(),f("span",_n,$(u[h.prop]),1))]),_:2},1032,["prop","label"]))),128)),t(w,{label:"操作"},{default:l(({row:h})=>[t(_,{type:"danger",onClick:u=>s.handleUndo(h),plain:"",class:"undo-button"},{default:l(()=>[m("撤销")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","height"]),a.total>a.pageSize?(i(),b(y,{key:0,onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange,"page-sizes":[10,30,50,100],"page-size":a.pageSize,total:a.total,layout:"sizes, prev, pager, next, jumper"},null,8,["onSizeChange","onCurrentChange","page-size","total"])):S("",!0)])]),_:1})}const fn=V(un,[["render",mn],["__scopeId","data-v-aadb2b60"]]),gn={data(){return{formData:{stuId:"",stuName:"输入学号后自动获取",type:"",description:""},typeOptions:[{value:"考勤-早签旷签",label:"考勤-早签旷签"},{value:"考勤-上课迟到",label:"考勤-上课迟到"},{value:"考勤-上课缺勤",label:"考勤-上课缺勤"},{value:"考勤-替课出勤",label:"考勤-替课出勤"},{value:"考勤-上机迟到",label:"考勤-上机迟到"},{value:"考勤-上机缺勤",label:"考勤-上机缺勤"},{value:"公寓-寝室卫生",label:"公寓-寝室卫生"},{value:"公寓-人走未断电",label:"公寓-人走未断电"},{value:"公寓-违禁物品",label:"公寓-违禁物品"},{value:"公寓-其他违纪情况",label:"公寓-其他违纪情况"},{value:"团组织-青年大学习未参加",label:"团组织-青年大学习未参加"},{value:"考试舞弊",label:"考试舞弊"},{value:"其他",label:"其他"}],rules:{stuId:[{required:!0,message:"请输入学号",trigger:"blur"}],stuName:[{required:!0,message:"请输入学号并获取姓名",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}]}}},methods:{async submitForm(){try{await this.$refs.form.validate(),await D.post("/discipline/push",this.formData),this.$message.success("上报成功"),this.resetForm()}catch{this.$message.error("上报失败")}},async fetchStudentName(){if(this.formData.stuId.length===9)try{const e=await D.get(`/discipline/getName?stuId=${this.formData.stuId}`);this.formData.stuName=e.data}catch{this.$message.error("获取姓名失败")}},resetForm(){this.$refs.form.resetFields()},handleStuIdInput(){this.formData.stuName="",this.fetchStudentName()}}},ze=e=>(T("data-v-91e47eb0"),e=e(),M(),e),bn={class:"container"},vn=ze(()=>n("h1",{class:"title"},"计算机科学技术学院通报预警备案",-1)),yn=ze(()=>n("p",{style:{color:"gray"}},"各部门均可上报，上报后不可更改，请务必认真检查。如有误报，请联系学生会综合部！",-1)),Dn=ze(()=>n("p",{style:{color:"gray"}},"“描述”为选填项，其他为必填项。其中“姓名”会根据所填学号自动输入，无需手动输入。",-1));function wn(e,o,r,p,a,s){const c=d("el-input"),_=d("el-form-item"),v=d("el-option"),w=d("el-select"),g=d("el-button"),y=d("el-form");return i(),f("div",bn,[vn,yn,Dn,t(y,{ref:"form",model:a.formData,"label-width":"100px",class:"form",rules:a.rules},{default:l(()=>[t(_,{label:"学号",prop:"stuId"},{default:l(()=>[t(c,{modelValue:a.formData.stuId,"onUpdate:modelValue":o[0]||(o[0]=x=>a.formData.stuId=x),clearable:"",onInput:s.handleStuIdInput,size:"large"},null,8,["modelValue","onInput"])]),_:1}),t(_,{label:"姓名",prop:"stuName"},{default:l(()=>[t(c,{modelValue:a.formData.stuName,"onUpdate:modelValue":o[1]||(o[1]=x=>a.formData.stuName=x),disabled:"",size:"large"},null,8,["modelValue"])]),_:1}),t(_,{label:"类型",prop:"type"},{default:l(()=>[t(w,{modelValue:a.formData.type,"onUpdate:modelValue":o[2]||(o[2]=x=>a.formData.type=x),placeholder:"请选择",clearable:"",size:"large"},{default:l(()=>[(i(!0),f(E,null,H(a.typeOptions,x=>(i(),b(v,{key:x.value,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(_,{label:"描述",prop:"description"},{default:l(()=>[t(c,{modelValue:a.formData.description,"onUpdate:modelValue":o[3]||(o[3]=x=>a.formData.description=x),clearable:"",style:{height:"100px"},size:"large"},null,8,["modelValue"])]),_:1}),t(_,null,{default:l(()=>[t(g,{type:"primary",onClick:s.submitForm,plain:"",size:"large"},{default:l(()=>[m("上报")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])])}const xn=V(gn,[["render",wn],["__scopeId","data-v-91e47eb0"]]),zn=[{path:"/login",component:it},{path:"/",component:Pt,redirect:"/dev",children:[{path:"/dev",component:to},{path:"/oneStep",component:El},{path:"/stu/uploadFile",component:Po},{path:"/stu/stuManage",component:Yo},{path:"/stu/exportExcel",component:sl},{path:"/oprRec/upload",component:dl},{path:"/oprRec/recManage",component:vl},{path:"/oprRec/exportExcel",component:Il},{path:"/user/info",component:ho},{path:"/user/UserAvatar",component:zo},{path:"/user/password",component:Uo},{path:"/files",component:Yl},{path:"/user/userManage",component:Sa},{path:"/fcblocked",component:Na},{path:"/orblocked",component:os},{path:"/or2blocked",component:fs},{path:"/oprRec2/upload",component:Ds},{path:"/oprRec2/recManage",component:ks},{path:"/oprRec2/exportExcel",component:As},{path:"/description",component:Ys},{path:"/discipline/manage",component:fn},{path:"/discipline/push",component:xn},{path:"/dpBlocked",component:cn}]},{path:"/v1/search",component:pa}],Fn=He({history:Ae(),routes:zn}),G=Fn,Cn={__name:"App",setup(e){return(o,r)=>{const p=d("router-view");return i(),b(p)}}},be=Me(Cn),$e=Ze(),kn=Je();$e.use(kn);be.use($e);be.use(G);be.use(Ue,{locale:Be});be.mount("#app");
